import{p as u}from"./index-D-pLzYyD.js";import{c as N}from"./chunk-Bz5IV6q8.js";const C=N(u((e,s)=>({adminNotifications:[],farmerNotifications:{},unreadAdminCount:0,unreadFarmerCount:0,addAdminNotification:o=>{e(r=>({adminNotifications:[{...o,read:!1},...r.adminNotifications],unreadAdminCount:r.unreadAdminCount+1}))},addFarmerNotification:(o,r)=>{e(t=>{const n=t.farmerNotifications[r]||[];return{farmerNotifications:{...t.farmerNotifications,[r]:[{...o,read:!1},...n]},unreadFarmerCount:t.unreadFarmerCount+1}})},markAdminNotificationsAsRead:()=>{e(o=>({adminNotifications:o.adminNotifications.map(r=>({...r,read:!0})),unreadAdminCount:0}))},markFarmerNotificationsAsRead:o=>{e(r=>{const t=r.farmerNotifications[o]||[],n=t.filter(i=>!i.read).length;return{farmerNotifications:{...r.farmerNotifications,[o]:t.map(i=>({...i,read:!0}))},unreadFarmerCount:Math.max(0,r.unreadFarmerCount-n)}})},removeNotification:(o,r)=>{e(t=>{const n=t.farmerNotifications[r]||[],i=n.find(c=>c.id===o),a=n.filter(c=>c.id!==o),f=i&&!i.read,d={farmerNotifications:{...t.farmerNotifications,[r]:a},unreadFarmerCount:f?Math.max(0,t.unreadFarmerCount-1):t.unreadFarmerCount};return setTimeout(()=>{try{const c=localStorage.getItem("notification-storage");if(c){const m=JSON.parse(c);m.state={...m.state,...d},localStorage.setItem("notification-storage",JSON.stringify(m))}}catch{}},0),d})},removeAdminNotification:o=>{e(r=>{const t=r.adminNotifications.find(a=>a.id===o),n=r.adminNotifications.filter(a=>a.id!==o),i=t&&!t.read;return{adminNotifications:n,unreadAdminCount:i?Math.max(0,r.unreadAdminCount-1):r.unreadAdminCount}})},getFarmerNotifications:o=>s().farmerNotifications[o]||[],getFarmerUnreadCount:o=>(s().farmerNotifications[o]||[]).filter(t=>!t.read).length,clearFarmerNotifications:o=>{e(r=>{const n=(r.farmerNotifications[o]||[]).filter(a=>!a.read).length,i={farmerNotifications:{...r.farmerNotifications,[o]:[]},unreadFarmerCount:Math.max(0,r.unreadFarmerCount-n)};return setTimeout(()=>{try{const a=localStorage.getItem("notification-storage");if(a){const f=JSON.parse(a);f.state={...f.state,...i},localStorage.setItem("notification-storage",JSON.stringify(f))}}catch{}},0),i})},clearNotifications:()=>{e({adminNotifications:[],farmerNotifications:{},unreadAdminCount:0,unreadFarmerCount:0})},clearFarmerNotificationsOnLogout:o=>{e(r=>{const{[o]:t,...n}=r.farmerNotifications,i=(t||[]).filter(a=>!a.read).length;return{farmerNotifications:n,unreadFarmerCount:Math.max(0,r.unreadFarmerCount-i)}})},forceClearFarmerNotifications:o=>{try{const r=localStorage.getItem("notification-storage");if(r){const t=JSON.parse(r);t.state&&t.state.farmerNotifications&&(delete t.state.farmerNotifications[o],localStorage.setItem("notification-storage",JSON.stringify(t)))}}catch{}e(r=>{const{[o]:t,...n}=r.farmerNotifications,i=(t||[]).filter(a=>!a.read).length;return{farmerNotifications:n,unreadFarmerCount:Math.max(0,r.unreadFarmerCount-i)}})}}),{name:"notification-storage"}));export{C as u};
