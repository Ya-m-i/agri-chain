import{p as ie,u as ae,j as e}from"./index-CTk4XTtR.js";import{R as w,r as j,u as ce}from"./chunk-_R7uuz6g.js";import{G as de,v as me,P as ue,a1 as Q}from"./chunk-CdYjsaZ7.js";import{u as ge}from"./chunk-CpiR3cQI.js";import{a as X,c as he,f as pe}from"./chunk-DG0IC7ks.js";import{c as fe}from"./chunk-Bz5IV6q8.js";import"./chunk-OzYVDPTe.js";const S=fe(ie((t,s)=>({step:1,formData:{name:"",address:"",phone:"",farmerLocation:"",crop:"",otherCropText:"",areaInsured:"",varietyPlanted:"",plantingDate:"",cicNumber:"",underwriter:"",program:[],otherProgramText:"",sketchFile:null,documents:[],damageType:"",lossDate:"",ageStage:"",areaDamaged:"",degreeOfDamage:"",expectedHarvest:"",damagePhotos:[],lotBoundaries:{1:{north:"",south:"",east:"",west:""},2:{north:"",south:"",east:"",west:""},3:{north:"",south:"",east:"",west:""},4:{north:"",south:"",east:"",west:""}},errors:{},touched:{}},isSubmitting:!1,submittedClaims:[],setStep:a=>t(()=>({step:a})),updateForm:(a,r)=>t(o=>({formData:{...o.formData,[a]:r,errors:{...o.formData.errors,[a]:void 0}}})),updateLotBoundary:(a,r,o)=>t(i=>({formData:{...i.formData,lotBoundaries:{...i.formData.lotBoundaries,[a]:{...i.formData.lotBoundaries[a],[r]:o}}}})),addDocument:a=>t(r=>({formData:{...r.formData,documents:[...r.formData.documents,...a]}})),removeDocument:a=>t(r=>({formData:{...r.formData,documents:r.formData.documents.filter((o,i)=>i!==a)}})),addDamagePhoto:a=>t(r=>({formData:{...r.formData,damagePhotos:[...r.formData.damagePhotos,...a]}})),removeDamagePhoto:a=>t(r=>({formData:{...r.formData,damagePhotos:r.formData.damagePhotos.filter((o,i)=>i!==a)}})),resetForm:()=>t(()=>({step:1,formData:{name:"",address:"",phone:"",farmerLocation:"",crop:"",otherCropText:"",areaInsured:"",varietyPlanted:"",plantingDate:"",cicNumber:"",underwriter:"",program:[],otherProgramText:"",sketchFile:null,documents:[],damageType:"",lossDate:"",ageStage:"",areaDamaged:"",degreeOfDamage:"",expectedHarvest:"",damagePhotos:[],lotBoundaries:{1:{north:"",south:"",east:"",west:""},2:{north:"",south:"",east:"",west:""},3:{north:"",south:"",east:"",west:""},4:{north:"",south:"",east:"",west:""}},errors:{},touched:{}}})),validateStep:a=>{const{formData:r}=s(),o={};return a===1&&(r.name||(o.name="Name is required"),r.address||(o.address="Address is required"),r.phone||(o.phone="Phone number is required"),r.crop||(o.crop="Crop type is required"),r.crop==="Other"&&!r.otherCropText&&(o.otherCropText="Please specify the crop type"),r.areaInsured||(o.areaInsured="Area insured is required")),a===2&&(r.damageType||(o.damageType="Cause of loss is required"),r.lossDate||(o.lossDate="Date of loss is required"),r.ageStage||(o.ageStage="Age/Stage is required"),r.areaDamaged||(o.areaDamaged="Area damaged is required"),r.degreeOfDamage||(o.degreeOfDamage="Degree of damage is required"),(!r.damagePhotos||r.damagePhotos.length===0)&&(o.damagePhotos="At least one damage photo is required")),t(i=>({formData:{...i.formData,errors:o}})),Object.keys(o).length===0},setFieldTouched:a=>{t(r=>({formData:{...r.formData,touched:{...r.formData.touched,[a]:!0}}}))},submitForm:async()=>{t({isSubmitting:!0});try{const{formData:a}=s(),r=ae.getState().user;if(!r)throw new Error("User not authenticated. Please login again.");if(!a.crop)throw new Error("Crop type is required");if(!a.areaDamaged||parseFloat(a.areaDamaged)<=0)throw new Error("Area damaged must be greater than 0");if(!a.degreeOfDamage||parseFloat(a.degreeOfDamage)<=0)throw new Error("Degree of damage must be greater than 0");const i=await(async c=>{const h=[];for(const d of c)if(d instanceof File)try{const v=await new Promise((f,D)=>{const b=new FileReader;b.onload=()=>f(b.result),b.onerror=D,b.readAsDataURL(d)});h.push(v)}catch{h.push("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==")}else typeof d=="string"&&d.startsWith("data:")?h.push(d):h.push("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==");return h})(a.damagePhotos),g={farmerId:r.id,name:r.name,address:r.address,phone:r.phone,crop:a.crop==="Other"?a.otherCropText:a.crop,areaInsured:parseFloat(a.areaInsured)||0,program:a.program,varietyPlanted:a.varietyPlanted,plantingDate:a.plantingDate?new Date(a.plantingDate).toISOString():null,cicNumber:a.cicNumber,underwriter:a.underwriter,damageType:a.damageType,lossDate:a.lossDate?new Date(a.lossDate).toISOString():null,ageStage:a.ageStage,areaDamaged:parseFloat(a.areaDamaged)||0,degreeOfDamage:parseFloat(a.degreeOfDamage)||0,expectedHarvest:a.expectedHarvest,damagePhotos:i,lotBoundaries:a.lotBoundaries,status:"pending",date:new Date().toISOString(),reviewDate:null,completionDate:null},l=await he(g);return t({isSubmitting:!1}),s().resetForm(),r&&r.id&&ge.getState().addFarmerNotification({id:`claim-submitted-${l._id}`,type:"success",title:"Claim Submitted Successfully",message:`Your claim for ${g.crop} has been submitted with claim number ${l.claimNumber}.`,timestamp:new Date},r.id),setTimeout(()=>{window.dispatchEvent(new CustomEvent("claimSubmitted",{detail:{claimId:l._id}}))},1e3),Promise.resolve()}catch(a){return t({isSubmitting:!1}),Promise.reject(a.message||"Failed to submit claim")}},getClaimsForFarmer:async a=>{try{return await X(a)}catch{return[]}},getClaims:async()=>{try{return await X()}catch{return[]}},updateClaimStatus:(a,r,o,i)=>{t(g=>({submittedClaims:g.submittedClaims.map(l=>l.id===a?{...l,status:r,adminFeedback:o,compensation:i}:l)}))}}),{name:"claim-form-storage",partialize:t=>{const{formData:s,step:a,submittedClaims:r}=t;return{step:a,submittedClaims:r,formData:{...s,sketchFile:null,documents:[],damagePhotos:[],errors:{},touched:{}}}}})),xe=()=>{const{step:t,setStep:s}=S(),a=t/3*100;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full bg-gray-300 rounded-full h-4 mb-8",children:e.jsx("div",{className:"bg-green-600 h-4 rounded-full transition-all duration-500 ease-in-out",style:{width:`${a}%`}})}),e.jsx("div",{className:"flex justify-around items-center mb-8",children:[1,2,3].map(r=>e.jsxs("button",{onClick:()=>s(r),className:`px-6 py-3 rounded-full shadow-lg font-semibold text-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-offset-2 transition-all duration-200 ${t===r?"bg-green-700 text-white transform scale-105":"bg-gray-300 text-gray-700 hover:bg-gray-400"}`,children:["Step ",r]},r))})]})};var re={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Z=w.createContext&&w.createContext(re),be=["attr","size","title"];function ve(t,s){if(t==null)return{};var a=je(t,s),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function je(t,s){if(t==null)return{};var a={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(s.indexOf(r)>=0)continue;a[r]=t[r]}return a}function F(){return F=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},F.apply(this,arguments)}function ee(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,r)}return a}function k(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ee(Object(a),!0).forEach(function(r){ye(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ee(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function ye(t,s,a){return s=Ne(s),s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Ne(t){var s=we(t,"string");return typeof s=="symbol"?s:s+""}function we(t,s){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function se(t){return t&&t.map((s,a)=>w.createElement(s.tag,k({key:a},s.attr),se(s.child)))}function y(t){return s=>w.createElement(De,F({attr:k({},t.attr)},s),se(t.child))}function De(t){var s=a=>{var{attr:r,size:o,title:i}=t,g=ve(t,be),l=o||a.size||"1em",c;return a.className&&(c=a.className),t.className&&(c=(c?c+" ":"")+t.className),w.createElement("svg",F({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,r,g,{className:c,style:k(k({color:t.color||a.color},a.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&w.createElement("title",null,i),t.children)};return Z!==void 0?w.createElement(Z.Consumer,null,a=>s(a)):s(re)}function Ce(t){return y({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(t)}function Se(t){return y({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M575.2 325.7c.2-1.9.8-3.7.8-5.6 0-35.3-28.7-64-64-64-12.6 0-24.2 3.8-34.1 10-17.6-38.8-56.5-66-101.9-66-61.8 0-112 50.1-112 112 0 3 .7 5.8.9 8.7-49.6 3.7-88.9 44.7-88.9 95.3 0 53 43 96 96 96h272c53 0 96-43 96-96 0-42.1-27.2-77.4-64.8-90.4zm-430.4-22.6c-43.7-43.7-43.7-114.7 0-158.3 43.7-43.7 114.7-43.7 158.4 0 9.7 9.7 16.9 20.9 22.3 32.7 9.8-3.7 20.1-6 30.7-7.5L386 81.1c4-11.9-7.3-23.1-19.2-19.2L279 91.2 237.5 8.4C232-2.8 216-2.8 210.4 8.4L169 91.2 81.1 61.9C69.3 58 58 69.3 61.9 81.1l29.3 87.8-82.8 41.5c-11.2 5.6-11.2 21.5 0 27.1l82.8 41.4-29.3 87.8c-4 11.9 7.3 23.1 19.2 19.2l76.1-25.3c6.1-12.4 14-23.7 23.6-33.5-13.1-5.4-25.4-13.4-36-24zm-4.8-79.2c0 40.8 29.3 74.8 67.9 82.3 8-4.7 16.3-8.8 25.2-11.7 5.4-44.3 31-82.5 67.4-105C287.3 160.4 258 140 224 140c-46.3 0-84 37.6-84 83.9z"},child:[]}]})(t)}function Pe(t){return y({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(t)}function te(t){return y({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(t)}function Ae(t){return y({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(t)}function Fe(t){return y({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M64 96H0c0 123.7 100.3 224 224 224v144c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V320C288 196.3 187.7 96 64 96zm384-64c-84.2 0-157.4 46.5-195.7 115.2 27.7 30.2 48.2 66.9 59 107.6C424 243.1 512 147.9 512 32h-64z"},child:[]}]})(t)}function ke(t){return y({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(t)}function Oe(t){return y({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(t)}const Be=()=>{var b,m,x,I,T,E,L,R,z,U,$,M,q,H,_,V,G,J,W,Y,K;const{formData:t,updateForm:s,setFieldTouched:a}=S(),r=ae(n=>n.user),[o,i]=j.useState([]),[g,l]=j.useState({}),[c,h]=j.useState({});j.useEffect(()=>{if(r){s("name",r.name||""),s("address",r.address||""),s("phone",r.phone||""),s("crop",r.cropType||""),s("areaInsured",r.cropArea||"");const u=JSON.parse(localStorage.getItem("farmers")||"[]").find(p=>p.farmerName===r.name||p.id===r.id||`${p.firstName} ${p.middleName} ${p.lastName}`.trim()===r.name);if(u&&u.rsbsaRegistered){const p=t.program||[];p.includes("RSBA")||s("program",[...p,"RSBA"])}}},[r,t.program,s]),j.useEffect(()=>{async function n(){if(!(r!=null&&r._id))return;const u=await pe(r._id),p=new Date,P=[],A={},O={};u.forEach(B=>{const N=B.cropType,oe=new Date(B.plantingDate),ne=parseInt(B.insuranceDayLimit),le=Math.floor((p-oe)/(1e3*60*60*24)),C=ne-le;C>=0?(P.push(N),A[N]=C,C<=5&&(O[N]=C===0?`Claim period for ${N} is over!`:`Only ${C} day(s) left to file a claim for ${N}!`)):O[N]=`Claim period for ${N} is over!`}),i(P),l(A),h(O)}n()},[r]);const d=(n,u)=>{s(n,u)},v=n=>{var p;const u=(p=n.target.files)==null?void 0:p[0];u&&d("sketchFile",u)},f=n=>{const u=n.target.files?Array.from(n.target.files):[],p=t.documents||[];s("documents",[...p,...u])},D=n=>{const u=[...t.documents];u.splice(n,1),s("documents",u)};return e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-8 flex items-center gap-2",children:[e.jsx(Fe,{className:"text-green-500"})," I. Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-gray-700 font-semibold mb-2",htmlFor:"farmer-name",children:["Name of Farmer-Assured ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{id:"farmer-name",placeholder:"Juan Dela Cruz",className:`pl-12 border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400 ${(b=t.errors)!=null&&b.name&&((m=t.touched)!=null&&m.name)?"border-red-500":""}`,value:t.name,onChange:n=>d("name",n.target.value),onBlur:()=>a("name"),required:!0}),e.jsx(Pe,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),((x=t.errors)==null?void 0:x.name)&&((I=t.touched)==null?void 0:I.name)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.name})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-gray-700 font-semibold mb-2",htmlFor:"address",children:["Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{id:"address",placeholder:"123 Rizal St, Sampaloc, Manila",className:`pl-12 border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400 ${(T=t.errors)!=null&&T.address&&((E=t.touched)!=null&&E.address)?"border-red-500":""}`,value:t.address,onChange:n=>d("address",n.target.value),onBlur:()=>a("address"),required:!0})]}),((L=t.errors)==null?void 0:L.address)&&((R=t.touched)==null?void 0:R.address)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.address})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-gray-700 font-semibold mb-2",htmlFor:"phone",children:["Cellphone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{id:"phone",placeholder:"09123456789",className:`pl-12 border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400 ${(z=t.errors)!=null&&z.phone&&((U=t.touched)!=null&&U.phone)?"border-red-500":""}`,value:t.phone,onChange:n=>d("phone",n.target.value),onBlur:()=>a("phone"),required:!0})]}),(($=t.errors)==null?void 0:$.phone)&&((M=t.touched)==null?void 0:M.phone)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.phone})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-gray-700 font-semibold mb-2",htmlFor:"farmer-location",children:["Location of Farmer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{id:"farmer-location",placeholder:"Barangay San Isidro, Quezon City",className:"pl-12 border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400",value:t.farmerLocation,onChange:n=>d("farmerLocation",n.target.value),required:!0})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-gray-700 font-semibold mb-2",htmlFor:"crop-type",children:["Insured Crops ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{id:"crop-type",className:`border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400 ${(q=t.errors)!=null&&q.crop&&((H=t.touched)!=null&&H.crop)?"border-red-500":""}`,value:t.crop,onChange:n=>d("crop",n.target.value),onBlur:()=>a("crop"),required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:o.length===0?"No insured crops available":"Select a crop"}),o.map(n=>e.jsxs("option",{value:n,children:[n," ",g[n]!==void 0?`(Days left: ${g[n]})`:""]},n))]}),t.crop&&c[t.crop]&&e.jsx("span",{className:`text-sm ${c[t.crop].includes("over")?"text-red-500":"text-yellow-600"}`,children:c[t.crop]})]}),((_=t.errors)==null?void 0:_.crop)&&((V=t.touched)==null?void 0:V.crop)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.crop})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-gray-700 font-semibold mb-2",htmlFor:"area-insured",children:["Area Insured (hectares) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"area-insured",placeholder:"5.0",className:`pl-4 border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400 ${(G=t.errors)!=null&&G.areaInsured&&((J=t.touched)!=null&&J.areaInsured)?"border-red-500":""}`,value:t.areaInsured,onChange:n=>d("areaInsured",n.target.value),onBlur:()=>a("areaInsured"),required:!0}),((W=t.errors)==null?void 0:W.areaInsured)&&((Y=t.touched)==null?void 0:Y.areaInsured)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.areaInsured})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-gray-700 font-semibold mb-2",children:["Program ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:["Regular","Sikat Saka","RSBA","APCP-CAP-PBD","PUNA","Cooperative Rice Farming"].map(n=>e.jsxs("label",{className:"inline-flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-green-600",checked:t.program.includes(n),onChange:u=>{const P=u.target.checked?[...t.program,n]:t.program.filter(A=>A!==n);d("program",P)}}),e.jsx("span",{className:"text-gray-700",children:n})]},n))}),((K=t.errors)==null?void 0:K.program)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.program})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"Sketch File"}),e.jsx("input",{type:"file",className:"border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400",onChange:v}),t.sketchFile&&e.jsxs("p",{className:"mt-2 text-sm text-green-600",children:["File selected: ",t.sketchFile.name]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"Supporting Documents"}),e.jsx("input",{type:"file",multiple:!0,className:"border p-4 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-green-400",onChange:f}),t.documents&&t.documents.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Selected files:"}),e.jsx("ul",{className:"list-disc pl-5",children:t.documents.map((n,u)=>e.jsxs("li",{className:"text-sm text-gray-600 flex justify-between items-center",children:[e.jsx("span",{children:n.name}),e.jsx("button",{type:"button",onClick:()=>D(u),className:"text-red-500 hover:text-red-700",children:"Remove"})]},u))})]})]})]})]})},Ie=()=>{var c,h,d,v,f,D,b;const{formData:t,updateForm:s,setFieldTouched:a,addDamagePhoto:r,removeDamagePhoto:o}=S();j.useEffect(()=>{s("areaDamaged",t.areaInsured||"0"),s("degreeOfDamage","50"),s("expectedHarvest","0")},[]);const i=(m,x)=>{s(m,x)},g=m=>{const x=m.target.files?Array.from(m.target.files):[];x.length>0&&r(x)},l=m=>{o(m)};return e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-8 flex items-center gap-2",children:[e.jsx(Se,{className:"text-yellow-500"})," II. Damage Indicators"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Cause of Loss"}),e.jsxs("select",{value:t.damageType,onChange:m=>i("damageType",m.target.value),onBlur:()=>a("damageType"),className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-yellow-400",children:[e.jsx("option",{value:"",children:"Select cause of loss"}),e.jsx("option",{value:"Typhoon",children:"Typhoon"}),e.jsx("option",{value:"Drought",children:"Drought"}),e.jsx("option",{value:"Floods",children:"Floods"}),e.jsx("option",{value:"Pest infestations",children:"Pest infestations"}),e.jsx("option",{value:"Disease outbreaks",children:"Disease outbreaks"}),e.jsx("option",{value:"Fire",children:"Fire"}),e.jsx("option",{value:"Theft (for animals)",children:"Theft (for animals)"})]}),((c=t.errors)==null?void 0:c.damageType)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.damageType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Date of Loss"}),e.jsx("input",{type:"date",value:t.lossDate,onChange:m=>i("lossDate",m.target.value),onBlur:()=>a("lossDate"),className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-yellow-400"}),((h=t.errors)==null?void 0:h.lossDate)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.lossDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Age/Stage of Cultivation at Time of Loss"}),e.jsxs("select",{value:t.ageStage,onChange:m=>i("ageStage",m.target.value),onBlur:()=>a("ageStage"),className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-yellow-400",children:[e.jsx("option",{value:"",children:"Select growth stage"}),e.jsx("option",{value:"Vegetative Stage",children:"Vegetative Stage"}),e.jsx("option",{value:"Reproductive Stage",children:"Reproductive Stage"}),e.jsx("option",{value:"Ripening/Grain Filling Stage",children:"Ripening/Grain Filling Stage"})]}),((d=t.errors)==null?void 0:d.ageStage)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.ageStage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Area Damaged (hectares)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:t.areaInsured,value:t.areaDamaged,onChange:m=>i("areaDamaged",m.target.value),onBlur:()=>a("areaDamaged"),className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-yellow-400",placeholder:"Enter damaged area"}),((v=t.errors)==null?void 0:v.areaDamaged)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.areaDamaged})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Degree of Damage (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:t.degreeOfDamage,onChange:m=>i("degreeOfDamage",m.target.value),onBlur:()=>a("degreeOfDamage"),className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-yellow-400",placeholder:"Enter degree of damage"}),((f=t.errors)==null?void 0:f.degreeOfDamage)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.degreeOfDamage})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Expected Harvest (tons)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.expectedHarvest,onChange:m=>i("expectedHarvest",m.target.value),onBlur:()=>a("expectedHarvest"),className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-yellow-400",placeholder:"Enter expected harvest"}),((D=t.errors)==null?void 0:D.expectedHarvest)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.expectedHarvest})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Damage Evidence Photos ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"border-2 border-dashed border-yellow-300 rounded-lg p-6 text-center hover:border-yellow-400 transition-colors",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:g,className:"hidden",id:"damage-photos-upload"}),e.jsxs("label",{htmlFor:"damage-photos-upload",className:"cursor-pointer",children:[e.jsx(Ce,{className:"mx-auto text-4xl text-yellow-500 mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Click to upload photos of the damage"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload multiple photos showing the extent of damage"})]})]}),t.damagePhotos&&t.damagePhotos.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["Uploaded Photos (",t.damagePhotos.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:t.damagePhotos.map((m,x)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:URL.createObjectURL(m),alt:`Damage evidence ${x+1}`,className:"w-full h-32 object-cover rounded-lg border"}),e.jsx("button",{type:"button",onClick:()=>l(x),className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ke,{size:12})})]},x))})]}),((b=t.errors)==null?void 0:b.damagePhotos)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.errors.damagePhotos})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Important Notice"}),e.jsx("p",{className:"text-yellow-800",children:"Please ensure all information provided is accurate. Claims with incorrect information may be delayed or rejected. Our team may conduct an on-site assessment to verify the damage reported."})]})]})},Te=()=>{const{formData:t,updateLotBoundary:s}=S(),[a,r]=j.useState([1]),o=(l,c,h)=>{s(l,c,h)},i=()=>{const l=Math.max(...a)+1;r([...a,l])},g=l=>{a.length>1&&r(a.filter(c=>c!==l))};return e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-8 flex items-center gap-2",children:[e.jsx(de,{className:"text-blue-500 h-7 w-7"})," III. Location Sketch / Plan of Damaged Crops (LSP)"]}),e.jsxs("div",{className:"space-y-8",children:[a.map(l=>{var c,h,d,v;return e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200 transition-all duration-300 hover:shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold text-blue-800 flex items-center gap-2",children:[e.jsx("div",{className:"bg-blue-700 text-white w-6 h-6 rounded-full flex items-center justify-center font-bold text-sm",children:l}),"Lot ",l," Details"]}),a.length>1&&e.jsx("button",{type:"button",onClick:()=>g(l),className:"text-red-500 hover:text-red-700 p-2",title:"Remove lot",children:e.jsx(me,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"North Boundary"}),e.jsx("input",{type:"text",placeholder:"e.g., Road",className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-400",value:((c=t.lotBoundaries[l])==null?void 0:c.north)||"",onChange:f=>o(l,"north",f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"South Boundary"}),e.jsx("input",{type:"text",placeholder:"e.g., River",className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-400",value:((h=t.lotBoundaries[l])==null?void 0:h.south)||"",onChange:f=>o(l,"south",f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"East Boundary"}),e.jsx("input",{type:"text",placeholder:"e.g., Farm",className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-400",value:((d=t.lotBoundaries[l])==null?void 0:d.east)||"",onChange:f=>o(l,"east",f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"West Boundary"}),e.jsx("input",{type:"text",placeholder:"e.g., Canal",className:"border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-400",value:((v=t.lotBoundaries[l])==null?void 0:v.west)||"",onChange:f=>o(l,"west",f.target.value)})]})]})]},l)}),e.jsxs("button",{type:"button",onClick:i,className:"flex items-center gap-2 text-blue-600 hover:text-blue-800 font-medium",children:[e.jsx(ue,{className:"h-5 w-5"}),"Add Another Lot"]})]}),e.jsxs("div",{className:"mt-8 bg-blue-50 rounded-lg p-6 border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"Visual Farm Sketch"}),e.jsx("div",{className:"relative",children:t.sketchFile?e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-green-700 mb-2",children:["✓ Sketch file uploaded: ",t.sketchFile.name]}),e.jsx("div",{className:"bg-white border-2 border-dashed border-gray-300 rounded-lg p-4 h-48 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Sketch preview would appear here in a real application"})})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-amber-700 mb-2",children:"No sketch file uploaded yet"}),e.jsxs("div",{className:"bg-white border-2 border-dashed border-gray-300 rounded-lg p-8 flex flex-col items-center justify-center",children:[e.jsx("p",{className:"text-gray-500 mb-3",children:"Please return to Step 1 to upload a sketch of your farm"}),e.jsx("button",{onClick:()=>setStep(1),className:"bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200 transition-colors",children:"Go to Step 1"})]})]})}),e.jsx("p",{className:"text-sm text-gray-600 mt-4",children:"Note: The sketch should clearly show the layout of your farm, including all lots, boundaries, and damaged areas."})]})]})},qe=()=>{const t=ce(),s=j.useRef(null),{step:a,setStep:r,validateStep:o,submitForm:i,isSubmitting:g}=S(),l=()=>{window.confirm("Are you sure you want to exit? Your progress will be saved.")&&t("/farmer-dashboard")},c=()=>{o(a)&&(r(a+1),window.scrollTo(0,0),s.current&&(s.current.scrollTop=0))},h=async()=>{try{await i(),Q.success("Claim submitted successfully!"),t("/farmer-dashboard")}catch(d){Q.error(typeof d=="string"?d:"Failed to submit claim. Please try again.")}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-green-200 via-green-100 to-green-200 p-6 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-4xl w-full bg-white shadow-2xl rounded-3xl p-8 relative",ref:s,children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 text-gray-600 hover:text-gray-800 text-2xl font-bold focus:outline-none","aria-label":"Close form",children:"×"}),e.jsxs("h1",{className:"text-5xl font-extrabold text-center text-green-800 mb-12 flex items-center justify-center gap-4",children:[e.jsx("span",{className:"text-green-600",children:"🚜"})," Claim for Indemnity"]}),e.jsx(xe,{}),a===1&&e.jsx(Be,{}),a===2&&e.jsx(Ie,{}),a===3&&e.jsx(Te,{}),e.jsxs("div",{className:"mt-12 flex justify-between",children:[a>1&&e.jsx("button",{onClick:()=>r(a-1),className:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-full shadow-xl",children:"Back"}),e.jsx("div",{className:"ml-auto",children:a<3?e.jsx("button",{onClick:c,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-full shadow-xl",children:"Continue"}):e.jsx("button",{onClick:h,disabled:g,className:`bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-full shadow-xl flex items-center ${g?"opacity-75 cursor-not-allowed":""}`,children:g?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):"Submit Claim"})})]})]})})};export{qe as default};
