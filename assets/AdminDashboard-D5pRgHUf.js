const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-OzYVDPTe.js","assets/chunk-_R7uuz6g.js"])))=>i.map(i=>d[i]);
import{_ as Rt}from"./chunk-OzYVDPTe.js";import{j as e,u as _a}from"./index-D-pLzYyD.js";import{g as Ua,r as o,u as Wa}from"./chunk-_R7uuz6g.js";import{u as D}from"./chunk-CG5JRJGZ.js";import{r as Qa}from"./chunk-hfhF5hzr.js";import{a as Ha}from"./chunk-CzMYLpXX.js";import{L as ls,D as Ls,B as ct,C as ys,a as mt,b as xt,P as qt,c as Yt,d as ut,p as Ot,e as Fs,f as zs,i as Bt,R as st,A as _t,X as tt,Y as at,T as rt,g as fs,h as pt,j as Ga,k as Pt,l as Va,m as Ja,n as gs,r as Ka,o as Za}from"./chunk-C-5rGKkD.js";import{T as $s,a as We,C as nt,b as Xa,d as gt,S as Je,e as Te,X as ee,F as er,U as Ve,f as lt,M as ze,g as Pe,P as is,h as Re,i as De,j as it,H as sr,k as Ut,l as hs,m as tr,n as ar,E as Wt,D as Mt,o as ot,I as Qt,p as rr,q as nr,r as lr,s as ir,t as Is,u as or,v as dr,V as ht,w as cr,B as mr,x as xr,y as ur,z as pr,A as Et,G as et,J as Ts,K as gr,N as hr}from"./chunk-CdYjsaZ7.js";import{u as ft,a as bt,b as Ht,c as Gt,d as fr,e as br,f as yr,g as jr,h as Nr,i as vr,j as wr,k as Cr,l as kr,m as Ar,n as Sr}from"./chunk-BHxgIrTI.js";import{f as Dr}from"./chunk-BqqKntmu.js";import{c as dt,g as Vt,a as Jt,b as Tr,d as $r}from"./chunk-CCXz5kst.js";import"./chunk-Bz5IV6q8.js";var Ir=Qa();const Fe=Ua(Ir);ys.register(mt,xt,qt,Yt,ut,Ot,Fs,zs,Bt);const Lr=({claims:x,approvedClaims:Q,generateAnalytics:m,analyticsLoading:C,allApplications:ie=[]})=>{const[H,A]=o.useState(!1),[i,k]=o.useState(""),[W,te]=o.useState("all"),[ce,K]=o.useState(null),[Z,se]=o.useState(!1),[d,f]=o.useState(!1),[b,u]=o.useState("quarterly"),[y,B]=o.useState(!1),[q,l]=o.useState([]),P=[...x.map(a=>({...a,type:"cash_claim",date:a.date,cropType:a.cropType||a.crop,status:a.status,amount:a.amount||0})),...ie.map(a=>({...a,type:"seed_assistance",date:a.applicationDate,cropType:a.cropType,status:a.status,amount:a.requestedQuantity||0}))],ae=P.map(a=>new Date(a.date).getFullYear()),oe=ae.length>0?Math.min(...ae):new Date().getFullYear(),L=ae.length>0?Math.max(...ae):new Date().getFullYear(),[Ce,Ne]=o.useState([]),[Y,ve]=o.useState([oe,L]),ke=Array.from(new Set(P.map(a=>a.cropType))).filter(Boolean),$e=Array.from(new Set(P.map(a=>a.status))).filter(Boolean),qe=P.filter(a=>{const N=new Date(a.date).getFullYear(),$=N>=Y[0]&&N<=Y[1],z=q.length===0||q.includes(a.cropType),R=Ce.length===0||Ce.includes(a.status);return $&&z&&R}),p=a=>l(N=>N.includes(a)?N.filter($=>$!==a):[...N,a]),j=a=>Ne(N=>N.includes(a)?N.filter($=>$!==a):[...N,a]),S=()=>{l([]),ve([oe,L]),Ne([])},de=()=>B(!1),n=()=>{const a=P.reduce((M,ne)=>{if(!ne.date)return M;const Ie=new Date(ne.date).getMonth();return M[Ie]=(M[Ie]||0)+1,M},{}),N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],$=N.map((M,ne)=>a[ne]||null),z=$.reduce((M,ne,Oe)=>ne!==null?Oe:M,-1),R=$.map((M,ne)=>({x:ne,y:M})).filter(M=>M.y!==null),pe=(()=>{var Be;if(R.length<2)return{slope:0,intercept:((Be=R[0])==null?void 0:Be.y)||0};const M=R.length,ne=R.reduce((Ee,Se)=>Ee+Se.x,0),Oe=R.reduce((Ee,Se)=>Ee+Se.y,0),Ie=R.reduce((Ee,Se)=>Ee+Se.x*Se.y,0),fe=R.reduce((Ee,Se)=>Ee+Se.x*Se.x,0),es=(M*Ie-ne*Oe)/(M*fe-ne*ne),Me=(Oe-es*ne)/M;return{slope:es,intercept:Me}})(),ds={quarterly:[],yearly:[]},cs=Math.floor(new Date().getMonth()/3);for(let M=1;M<=4;M++){const ne=(cs+M)*3,Oe=pe.slope*ne+pe.intercept;ds.quarterly.push({period:`Q${M} ${new Date().getFullYear()}`,predicted:Math.max(0,Math.round(Oe))})}const Ze=new Date().getFullYear();for(let M=1;M<=3;M++){const ne=pe.slope*(12*M)+pe.intercept;ds.yearly.push({period:`${Ze+M}`,predicted:Math.max(0,Math.round(ne*12))})}return{predictions:ds,chartData:{labels:N,historical:$,lastMonthWithData:z}}},{predictions:h,chartData:I}=n(),V={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!1},tooltip:{mode:"index",intersect:!1,callbacks:{label:a=>a.raw===null?"No data":`${a.raw} distributions`}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Number of Distributions"}},x:{grid:{display:!1}}},interaction:{mode:"nearest",axis:"x",intersect:!1}},F=()=>{const{labels:a,historical:N,lastMonthWithData:$}=I,z=new Array($+1).fill(null);return b==="quarterly"?h.quarterly.forEach(R=>{z.push(R.predicted)}):h.yearly.forEach(R=>{z.push(R.predicted)}),{labels:a,datasets:[{label:"Actual Distributions",data:N,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.5)",pointRadius:5,pointHoverRadius:8,spanGaps:!1},{label:"Predicted Distributions",data:z,borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.5)",borderDash:[5,5],pointRadius:4,pointHoverRadius:7,spanGaps:!0}]}},G={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!1},tooltip:{mode:"index",intersect:!1,callbacks:{label:a=>{const N=a.raw,$=a.dataset.data.reduce((R,pe)=>R+pe,0),z=(N/$*100).toFixed(1);return`${N} (${z}%)`}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Number of Distributions"}},x:{grid:{display:!1}}}},re=()=>{const a=b==="quarterly"?h.quarterly.map($=>$.period):h.yearly.map($=>$.period),N=b==="quarterly"?h.quarterly.map($=>$.predicted):h.yearly.map($=>$.predicted);return{labels:a,datasets:[{label:"Predicted Distributions",data:N,backgroundColor:"rgba(53, 162, 235, 0.5)",borderColor:"rgb(53, 162, 235)",borderWidth:1}]}},X=P.length,c=P.filter(a=>a.status==="distributed"||a.status==="completed"||a.status==="approved").length,T=P.filter(a=>a.status==="approved").length,me=P.filter(a=>a.status==="pending").length,ue=P.filter(a=>a.status==="rejected").length,Ke=X-c-T-me-ue;function os(a){const N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],$={};return N.forEach((z,R)=>{$[R]=0}),a.forEach(z=>{const pe=new Date(z.date).getMonth();$[pe]=($[pe]||0)+1}),N.map((z,R)=>({x:z,y:$[R]}))}const Ae=os(P);function Ye(a){const N=["Q1","Q2","Q3","Q4"],$={};return N.forEach((z,R)=>{$[R]=0}),a.forEach(z=>{const R=new Date(z.date),pe=Math.floor(R.getMonth()/3);$[pe]=($[pe]||0)+1}),N.map((z,R)=>({x:z,y:$[R]}))}const Qe=Ye(P);return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx($s,{size:24,className:"text-lime-600 mr-2"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Distribution Records"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>A(a=>!a),className:"flex items-center gap-3 bg-gradient-to-br from-purple-50 to-indigo-50 hover:from-purple-100 hover:to-indigo-100 text-gray-700 px-6 py-4 rounded-xl shadow-md border border-purple-200 transition-all duration-200 hover:shadow-lg min-w-[200px]",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-purple-500 to-indigo-500 rounded-lg",children:e.jsx(We,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:"Filter by Status"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Manage records"})]}),e.jsx(nt,{size:16,className:`ml-auto transition-transform ${H?"rotate-180":""}`})]}),H&&e.jsx("div",{className:"absolute z-10 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg",children:["all","approved","rejected","completed"].map(a=>e.jsx("button",{onClick:()=>{te(a),A(!1)},className:`block w-full text-left px-4 py-2 hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${W===a?"bg-green-50 text-lime-700 font-medium":""}`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]}),e.jsxs("button",{onClick:m,disabled:C,className:`flex items-center gap-3 bg-gradient-to-br from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100 text-gray-700 px-6 py-4 rounded-xl shadow-md border border-green-200 transition-all duration-200 hover:shadow-lg min-w-[220px] ${C?"opacity-70 cursor-not-allowed":""}`,children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-500 rounded-lg",children:C?e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(Xa,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:C?"Generating...":"Generate Distribution Forecast"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Predictive analytics"})]})]}),e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-3 bg-gradient-to-br from-blue-50 to-cyan-50 hover:from-blue-100 hover:to-cyan-100 text-gray-700 px-6 py-4 rounded-xl shadow-md border border-blue-200 transition-all duration-200 hover:shadow-lg min-w-[200px]",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-lg",children:e.jsx(gt,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:"View Forecast Analysis"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Analytics insights"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Je,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search by name or crop...",value:i,onChange:a=>k(a.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full md:w-64 shadow-sm focus:outline-none focus:ring-2 focus:ring-lime-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"rounded-xl p-4 w-full max-w-md h-64 flex flex-col",children:[e.jsx("h4",{className:"text-sm font-semibold text-lime-800 mb-2",children:"Claims Forecast (Quarterly)"}),e.jsx("div",{className:"flex-1",children:e.jsx(ls,{data:{labels:Qe.map(a=>a.x),datasets:[{label:"Claims",data:Qe.map(a=>a.y),borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.3)",fill:!0,pointRadius:0,tension:.4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#10B981",borderWidth:1,cornerRadius:8,callbacks:{label:function(a){return`Claims: ${a.parsed.y}`}}}},interaction:{mode:"nearest",axis:"x",intersect:!1},scales:{y:{beginAtZero:!0,display:!0,title:{display:!0,text:"Number of Claims",font:{size:12}},ticks:{font:{size:10}},grid:{display:!1,color:"rgba(0,0,0,0.1)"}},x:{display:!0,title:{display:!0,text:"Quarter",font:{size:12}},ticks:{font:{size:10}},grid:{display:!1,color:"rgba(0,0,0,0.1)"}}},elements:{point:{radius:0}}}})})]}),e.jsxs("div",{className:"rounded-xl p-4 w-full max-w-md h-64 flex flex-col",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-800 mb-2",children:"Claims Trends (Monthly)"}),e.jsx("div",{className:"flex-1",children:e.jsx(ls,{data:{labels:Ae.map(a=>a.x),datasets:[{label:"Claims",data:Ae.map(a=>a.y),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.3)",fill:!0,pointRadius:0,tension:.4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#3B82F6",borderWidth:1,cornerRadius:8,callbacks:{label:function(a){return`Claims: ${a.parsed.y}`}}}},interaction:{mode:"nearest",axis:"x",intersect:!1},scales:{y:{beginAtZero:!0,display:!0,title:{display:!0,text:"Number of Claims",font:{size:12}},ticks:{font:{size:10}},grid:{display:!1,color:"rgba(0,0,0,0.1)"}},x:{display:!0,title:{display:!0,text:"Month",font:{size:12}},ticks:{font:{size:10}},grid:{display:!1,color:"rgba(0,0,0,0.1)"}}},elements:{point:{radius:0}}}})})]}),e.jsxs("div",{className:"rounded-xl p-4 w-full max-w-md h-64 flex flex-col",children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-800 mb-2",children:"Assistance Application Status"}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(Ls,{data:{labels:["Distributed","Approved","Pending","Rejected","Unused"],datasets:[{data:[c,T,me,ue,Ke],backgroundColor:["#065F46","#047857","#10B981","#34D399","#6EE7B7"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{padding:10,usePointStyle:!0,font:{size:11}}},tooltip:{enabled:!0,backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#8B5CF6",borderWidth:1,cornerRadius:8,callbacks:{label:function(a){const N=a.dataset.data.reduce((z,R)=>z+R,0),$=(a.parsed/N*100).toFixed(1);return`${a.label}: ${a.parsed} (${$}%)`}}}},cutout:"60%"}})})]})]}),Q===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx($s,{size:48,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-500 italic",children:"No distribution records available."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 bg-gray-50 rounded-l-lg font-semibold text-gray-600",children:"Claim ID"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Farmer Name"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Crop Type"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Distribution Date"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Status"}),e.jsx("th",{className:"p-3 bg-gray-50 rounded-r-lg font-semibold text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{children:x.filter(a=>W==="all"?!0:a.status.toLowerCase()===W).filter(a=>{var N,$;return((N=a.name)==null?void 0:N.toLowerCase().includes(i.toLowerCase()))||(($=a.crop)==null?void 0:$.toLowerCase().includes(i.toLowerCase()))}).map((a,N)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border-b border-gray-200 font-mono text-sm",children:a.claimNumber||`DIST-${new Date(a.date).getFullYear()}-${String(N+1).padStart(4,"0")}`}),e.jsx("td",{className:"p-3 border-b border-gray-200 font-medium",children:a.name}),e.jsx("td",{className:"p-3 border-b border-gray-200",children:a.crop}),e.jsx("td",{className:"p-3 border-b border-gray-200",children:new Date(a.date).toLocaleDateString()}),e.jsx("td",{className:"p-3 border-b border-gray-200",children:e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-lime-800 rounded-full text-xs font-medium inline-flex items-center",children:[e.jsx(Te,{size:12,className:"mr-1"}),"Completed"]})}),e.jsx("td",{className:"p-3 border-b border-gray-200",children:e.jsx("button",{onClick:()=>{K(a),se(!0)},className:"text-blue-600 hover:text-blue-800 font-medium",children:"View Details"})})]},a._id||a.id||`${a.name}-${a.date}-${N}`))})]})})]}),Z&&ce&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Distribution Details"}),e.jsx("button",{onClick:()=>se(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(ee,{size:24})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Farmer Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",ce.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Contact:"})," ",ce.phone||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Address:"})," ",ce.address||"N/A"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Distribution Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Crop Type:"})," ",ce.crop]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"})," ",new Date(ce.date).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Status:"})," Completed"]})]})]})]})})]})}),d&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Distribution Forecasting Analysis"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>u("quarterly"),className:`px-4 py-2 rounded-lg ${b==="quarterly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Quarterly Forecast"}),e.jsx("button",{onClick:()=>u("yearly"),className:`px-4 py-2 rounded-lg ${b==="yearly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Yearly Forecast"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Distribution Trends"}),e.jsx("div",{className:"w-full h-[300px] relative",children:e.jsx(ls,{data:F(),options:V})})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:e.jsx("div",{style:{height:"300px"},children:e.jsx(ct,{options:G,data:re()})})})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-medium mb-4",children:[b==="quarterly"?"Quarterly":"Yearly"," Distribution Forecast"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:h[b].map(a=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:a.period}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.predicted}),e.jsx("div",{className:"text-xs text-gray-400",children:"Predicted Distributions"})]},a.period))}),e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"Forecast Analysis"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Based on historical distribution patterns and regression analysis, we predict a ",b==="quarterly"?"quarterly average of "+Math.round(h.quarterly.reduce((a,N)=>a+N.predicted,0)/4):"yearly average of "+Math.round(h.yearly.reduce((a,N)=>a+N.predicted,0)/3)," distributions."]}),e.jsx("p",{className:"text-sm text-gray-500",children:"* Forecasts are calculated using advanced regression analysis with seasonal adjustments"})]})]})]})]})}),e.jsx("button",{className:"fixed bottom-8 right-8 z-50 bg-lime-700 text-white rounded-full shadow-lg p-4 hover:bg-lime-800 transition",onClick:()=>B(!0),"aria-label":"Open analytics filters",children:e.jsx(er,{className:"w-6 h-6"})}),y&&e.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 transition-opacity duration-300",onClick:()=>B(!1)}),e.jsxs("div",{className:"relative ml-auto w-full max-w-md bg-white shadow-2xl h-full flex flex-col p-8 transform transition-transform duration-300 translate-x-0",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Filter Analytics"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[q.map(a=>e.jsxs("span",{className:"inline-flex items-center bg-lime-100 text-lime-800 px-3 py-1 rounded-full text-xs font-medium",children:[a,e.jsx("button",{onClick:()=>p(a),className:"ml-2 text-lime-700 hover:text-lime-900",children:"×"})]},a)),Ce.map(a=>e.jsxs("span",{className:"inline-flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs font-medium",children:[a.charAt(0).toUpperCase()+a.slice(1),e.jsx("button",{onClick:()=>j(a),className:"ml-2 text-blue-700 hover:text-blue-900",children:"×"})]},a)),(Y[0]!==oe||Y[1]!==L)&&e.jsxs("span",{className:"inline-flex items-center bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-xs font-medium",children:[Y[0]," - ",Y[1],e.jsx("button",{onClick:S,className:"ml-2 text-gray-700 hover:text-gray-900",children:"×"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Crop Type"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ke.map(a=>e.jsx("button",{className:`px-3 py-1 rounded-full border ${q.includes(a)?"bg-lime-700 text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>p(a),type:"button",children:a},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Year Range"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:oe,max:L,value:Y[0],onChange:a=>ve([Number(a.target.value),Y[1]]),className:"w-full"}),e.jsx("span",{className:"text-xs",children:Y[0]}),e.jsx("span",{className:"mx-1",children:"-"}),e.jsx("input",{type:"range",min:oe,max:L,value:Y[1],onChange:a=>ve([Y[0],Number(a.target.value)]),className:"w-full"}),e.jsx("span",{className:"text-xs",children:Y[1]})]}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:oe}),e.jsx("span",{children:L})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$e.map(a=>e.jsx("button",{className:`px-3 py-1 rounded-full border ${Ce.includes(a)?"bg-lime-700 text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>j(a),type:"button",children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]})]}),e.jsxs("div",{className:"mt-auto flex gap-4 pt-8",children:[e.jsx("button",{className:"flex-1 bg-gray-200 rounded py-2",onClick:S,children:"Reset"}),e.jsx("button",{className:"flex-1 bg-lime-700 text-white rounded py-2",onClick:de,children:"Apply"})]}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:["Showing ",qe.length," results"]})]})]})]})};async function Fr(){const x=await Dr(),Q={};return x.forEach(m=>{const C=m.cropType||"Unknown";Q[C]=(Q[C]||0)+1}),Q}ys.register(pt,Fs,zs);const zr=({formData:x,setFormData:Q,setShowMapModal:m,setMapMode:C,selectedLocation:ie,setSelectedLocation:H})=>{const{data:A=[],isLoading:i,refetch:k}=ft(),{data:W=[],isLoading:te}=bt(),ce=Ht(),K=Gt(),[Z,se]=o.useState(!1),[d,f]=o.useState(""),[b,u]=o.useState("monthly"),[y,B]=o.useState(new Date().getFullYear()),q=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,[l,P]=o.useState(null),[ae,oe]=o.useState(!1),[L,Ce]=o.useState(null),[Ne,Y]=o.useState(!1),[ve,ke]=o.useState({}),$e=o.useMemo(()=>{const n={};return W.forEach(h=>{const I=h.farmerId;n[I]||(n[I]=[]),n[I].push(h)}),n},[W]);o.useEffect(()=>{async function n(){const h=await Fr();ke(h)}n()},[]);const qe=n=>{const h=n._id||n.id;let I=$e[h]||[];if(I.length===0){const F=n.farmerName||`${n.firstName||""} ${n.middleName||""} ${n.lastName||""}`.trim();Object.values($e).flat().forEach(G=>{var re,X;(G.farmerName===F||((re=G.farmerId)==null?void 0:re.firstName)===n.firstName||((X=G.farmerId)==null?void 0:X.lastName)===n.lastName)&&I.push(G)})}return I.length===0?n.cropType||"No crops insured":[...new Set(I.map(F=>F.cropType))].join(", ")},p=()=>{const n=y;if(b==="monthly"){const h=[],I=["January","February","March","April","May","June","July","August","September","October","November","December"];for(let V=0;V<12;V++){const F=A.filter(G=>{const re=G.registrationDate||G.createdAt||G.date||G.registeredAt;if(!re)return!1;let X;try{if(X=new Date(re),isNaN(X.getTime()))return!1}catch{return!1}return X.getFullYear()===n&&X.getMonth()===V}).length;h.push({period:I[V],month:V+1,count:F,cumulative:h.length>0?h[h.length-1].cumulative+F:F})}return h}else{const h=[],I=["Q1","Q2","Q3","Q4"];for(let V=0;V<4;V++){const F=V*3,G=F+2,re=A.filter(X=>{const c=X.registrationDate||X.createdAt||X.date||X.registeredAt;if(!c)return!1;let T;try{if(T=new Date(c),isNaN(T.getTime()))return!1}catch{return!1}const me=T.getMonth();return T.getFullYear()===n&&me>=F&&me<=G}).length;h.push({period:I[V],quarter:V+1,count:re,cumulative:h.length>0?h[h.length-1].cumulative+re:re})}return h}},j=n=>{const{name:h,value:I,type:V,checked:F}=n.target;Q(G=>({...G,[h]:V==="checkbox"?F:I}))},S=async n=>{n.preventDefault();const h={...x,farmerName:`${x.firstName} ${x.middleName} ${x.lastName}`.trim(),location:ie,registrationDate:new Date().toISOString()};try{const I=await ce.mutateAsync(h);D.getState().addAdminNotification({id:q(),type:"success",title:"Farmer Registered Successfully",message:`New farmer ${h.farmerName} has been registered successfully.`,timestamp:new Date}),D.getState().addFarmerNotification({id:q(),type:"success",title:"Registration Successful",message:`Welcome ${h.farmerName}! Your account has been created successfully. You can now log in with your credentials.`,timestamp:new Date},I._id),Q({firstName:"",middleName:"",lastName:"",birthday:"",gender:"",contactNum:"",address:"",cropArea:"",lotNumber:"",lotArea:"",agency:"",isCertified:!1,periodFrom:"",periodTo:"",username:"",password:"",rsbsaRegistered:!1}),H(null),se(!1)}catch{D.getState().addAdminNotification({id:q(),type:"error",title:"Registration Failed",message:"Failed to register farmer. Please try again.",timestamp:new Date})}};o.useEffect(()=>{},[ie]);const de=A.filter(n=>{var h;return!(x.isCertified!==""&&x.isCertified!==void 0&&x.isCertified!==null&&n.isCertified!==x.isCertified||x.cropType&&x.cropType!==""&&(n.cropType||"")!==x.cropType||x.barangay&&x.barangay!==""&&((h=(n.address||"").split(",")[0])==null?void 0:h.trim())!==x.barangay||x.availedItems&&x.availedItems!==""&&!(Array.isArray(n.availedItems)?n.availedItems:typeof n.availedItems=="string"?[n.availedItems]:[]).includes(x.availedItems)&&!(n.insuranceType||"").toLowerCase().includes((x.availedItems||"").toLowerCase())||d&&d!==""&&!(n.farmerName||`${n.firstName||""} ${n.middleName||""} ${n.lastName||""}`.replace(/  +/g," ").trim()).toLowerCase().includes(d.toLowerCase()))});return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Ve,{size:24,className:"text-lime-600 mr-2"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Farmer Registration"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsxs("button",{className:"bg-lime-600 text-white px-4 py-2 rounded-lg hover:bg-lime-700 transition-colors flex items-center justify-center shadow-sm",onClick:()=>se(!0),children:[e.jsx(Ve,{className:"mr-2 h-5 w-5"}),"Register New Farmer"]}),e.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center shadow-sm",onClick:()=>{k()},disabled:i||te,children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),i||te?"Refreshing...":"Refresh Data"]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(lt,{size:20,className:"text-blue-600 mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Farm List"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",e.jsx("span",{className:"font-semibold",children:A.length})," farmers"]})]}),e.jsxs("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-lime-50 to-white rounded-xl shadow-lg p-4 flex flex-col items-center text-center border border-lime-100",children:[e.jsx(We,{className:"h-6 w-6 text-lime-600 mb-2"}),e.jsx("span",{className:"text-xs font-semibold text-lime-700 mb-1",children:"Crop Type"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-lime-500 text-sm",value:x.cropType||"",onChange:n=>Q(h=>({...h,cropType:n.target.value})),children:[e.jsx("option",{value:"",children:"All Crops"}),[...new Set(A.map(n=>n.cropType))].filter(Boolean).map((n,h)=>e.jsx("option",{value:n,children:n},h))]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white rounded-xl shadow-lg p-4 flex flex-col items-center text-center border border-blue-100",children:[e.jsx(ze,{className:"h-6 w-6 text-blue-600 mb-2"}),e.jsx("span",{className:"text-xs font-semibold text-blue-700 mb-1",children:"Barangay"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",value:x.barangay||"",onChange:n=>Q(h=>({...h,barangay:n.target.value})),children:[e.jsx("option",{value:"",children:"All Barangays"}),[...new Set(A.map(n=>{var h,I;return(I=(h=n.address)==null?void 0:h.split(",")[0])==null?void 0:I.trim()}).filter(Boolean))].map((n,h)=>e.jsx("option",{value:n,children:n},h))]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-white rounded-xl shadow-lg p-4 flex flex-col items-center text-center border border-yellow-100",children:[e.jsx(Pe,{className:"h-6 w-6 text-yellow-600 mb-2"}),e.jsx("span",{className:"text-xs font-semibold text-yellow-700 mb-1",children:"Availed Items"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-yellow-500 text-sm",value:x.availedItems||"",onChange:n=>Q(h=>({...h,availedItems:n.target.value})),children:[e.jsx("option",{value:"",children:"All Items"}),e.jsx("option",{value:"seeds",children:"Seeds"}),e.jsx("option",{value:"fertilizer",children:"Fertilizer"}),e.jsx("option",{value:"pesticides",children:"Pesticides"}),e.jsx("option",{value:"equipment",children:"Equipment"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-white rounded-xl shadow-lg p-4 flex flex-col items-center text-center border border-emerald-100",children:[e.jsx(Te,{className:"h-6 w-6 text-emerald-600 mb-2"}),e.jsx("span",{className:"text-xs font-semibold text-emerald-700 mb-1",children:"Certification"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-sm",value:x.isCertified===!0?"yes":x.isCertified===!1?"no":"",onChange:n=>{const h=n.target.value==="yes"?!0:n.target.value==="no"?!1:"";Q(I=>({...I,isCertified:h}))},children:[e.jsx("option",{value:"",children:"All Certifications"}),e.jsx("option",{value:"yes",children:"Certified"}),e.jsx("option",{value:"no",children:"Not Certified"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-xl shadow-lg p-4 flex flex-col items-center text-center border border-gray-100",children:[e.jsx(Je,{className:"h-6 w-6 text-gray-600 mb-2"}),e.jsx("span",{className:"text-xs font-semibold text-gray-700 mb-1",children:"Search"}),e.jsx("input",{type:"text",className:"w-full border border-gray-200 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-gray-500 text-sm",placeholder:"Search by name",value:d,onChange:n=>f(n.target.value)})]})]}),e.jsxs("div",{className:"w-full flex flex-col md:flex-row gap-6 mb-6",children:[e.jsxs("div",{className:"flex-1 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-lime-700 flex items-center gap-2",children:[e.jsx(lt,{className:"h-5 w-5 text-lime-600"})," Registered Farmers Over Time"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Period:"}),e.jsxs("select",{value:b,onChange:n=>u(n.target.value),className:"px-3 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"})]}),e.jsx("select",{value:y,onChange:n=>B(parseInt(n.target.value)),className:"px-3 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent",children:Array.from({length:5},(n,h)=>new Date().getFullYear()-h).map(n=>e.jsx("option",{value:n,children:n},n))})]})]}),e.jsx("div",{className:"h-64",children:e.jsx(st,{width:"100%",height:"100%",children:e.jsxs(_t,{data:p(),margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx(tt,{dataKey:"period",stroke:"#6b7280",fontSize:12,tick:{fontSize:10}}),e.jsx(at,{stroke:"#6b7280",fontSize:12,allowDecimals:!1,label:{value:"Number of Registered Farmers",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fontSize:12}}}),e.jsx(rt,{formatter:(n,h)=>[`${n} farmers`,h==="cumulative"?"Total Registered":"New Registrations"],labelFormatter:n=>`${n} ${y}`}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"farmerGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#22c55e",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#bbf7d0",stopOpacity:.3})]})}),e.jsx(fs,{type:"monotone",dataKey:"cumulative",stroke:"#22c55e",fill:"url(#farmerGradient)",strokeWidth:3,name:"cumulative"}),e.jsx(fs,{type:"monotone",dataKey:"count",stroke:"#059669",fill:"#10b981",fillOpacity:.4,strokeWidth:2,name:"count"})]})})})]}),e.jsxs("div",{className:"flex-1 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 text-emerald-700 flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5 text-emerald-600"})," Crop Type Distribution"]}),e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsx(Ls,{data:{labels:Object.keys(ve),datasets:[{data:Object.values(ve),backgroundColor:["#bbf7d0","#6ee7b7","#34d399","#10b981","#059669","#047857","#065f46","#fef08a","#fde68a","#fca5a5","#f87171","#a7f3d0","#f9fafb"],borderColor:"#fff",borderWidth:2}]},options:{cutout:"70%",plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:16}},tooltip:{enabled:!0}}}})})]})]}),de.length>0?e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 table-auto",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 rounded-tl-lg whitespace-normal break-words",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 whitespace-normal break-words",children:"Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 whitespace-normal break-words",children:"Crop"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 whitespace-normal break-words",children:"Lot No."}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 whitespace-normal break-words",children:"Lot Area"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 whitespace-normal break-words",children:"Certified"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 whitespace-normal break-words",children:"Location"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 rounded-tr-lg whitespace-normal break-words",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:de.map((n,h)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm font-medium text-gray-900",children:n.farmerName||`${n.firstName||""} ${n.middleName||""} ${n.lastName||""}`.replace(/  +/g," ").trim()}),e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm text-gray-500",children:n.address}),e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm text-gray-500",children:te?e.jsx("span",{className:"text-gray-400",children:"Loading..."}):e.jsx("span",{className:"font-medium text-green-600",children:qe(n)})}),e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm text-gray-500",children:n.lotNumber}),e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm text-gray-500",children:n.lotArea}),e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm text-gray-500",children:n.isCertified?e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-lime-800 rounded-full text-xs font-medium",children:[e.jsx(Te,{size:12,className:"inline mr-1"})," Yes"]}):e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs font-medium",children:"No"})}),e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm text-gray-500",children:n.location?e.jsxs("button",{className:"text-blue-600 hover:text-blue-800 flex items-center",children:[e.jsx(ze,{className:"h-4 w-4 mr-1"}),"View"]}):e.jsxs("button",{className:"text-gray-500 hover:text-gray-700 flex items-center",children:[e.jsx(is,{className:"h-4 w-4 mr-1"}),"Add"]})}),e.jsx("td",{className:"px-4 py-4 whitespace-normal break-words text-sm text-gray-500",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>{P(n),oe(!0)},className:"text-blue-600 hover:text-blue-800 font-medium flex items-center",children:[e.jsx(Re,{size:14,className:"mr-1"}),"View"]}),e.jsxs("button",{onClick:()=>{Ce(n),Y(!0)},className:"text-red-600 hover:text-red-800 font-medium flex items-center",children:[e.jsx(ee,{size:14,className:"mr-1"}),"Delete"]})]})})]},h))})]})}):e.jsxs("div",{className:"p-10 text-center mb-6",children:[e.jsx(Ve,{size:48,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-500 italic",children:"No farmers match the current filters."}),e.jsx("button",{className:"mt-4 bg-lime-600 text-white px-4 py-2 rounded-lg hover:bg-lime-700 transition-colors",onClick:()=>{Q({...x,isCertified:"",cropType:"",address:"",availedItems:""}),f("")},children:"Reset Filters"})]}),Z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 text-white p-5 rounded-t-xl flex justify-between items-center",style:{backgroundColor:"rgb(43, 158, 102)"},children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Register a New Farmer"}),e.jsx("button",{className:"text-white hover:text-gray-200 focus:outline-none",onClick:()=>se(!1),children:e.jsx(ee,{size:24})})]}),e.jsx("div",{className:"p-6 md:p-8",children:e.jsxs("form",{onSubmit:S,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white rounded-xl shadow-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Re,{size:20,className:"text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Personal Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Re,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"firstName",value:x.firstName||"",onChange:j,placeholder:"Enter first name",className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Middle Name"}),e.jsx("input",{type:"text",name:"middleName",value:x.middleName||"",onChange:j,placeholder:"Enter middle name (optional)",className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:x.lastName||"",onChange:j,placeholder:"Enter last name",className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Birthday"}),e.jsx("input",{type:"date",name:"birthday",value:x.birthday||"",onChange:j,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("select",{name:"gender",value:x.gender||"",onChange:j,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number"}),e.jsx("input",{type:"tel",name:"contactNum",value:x.contactNum||"",onChange:j,placeholder:"Enter contact number (e.g., 09123456789)",className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-white rounded-xl shadow-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(ze,{size:20,className:"text-green-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Address Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-auto cursor-pointer",onClick:()=>{m(!0),C("add")},children:e.jsx(ze,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"address",value:x.address||"",onChange:j,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",required:!0,readOnly:!0,placeholder:"Click the map icon to select location"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click the map icon to select location automatically"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-auto cursor-pointer",onClick:()=>{m(!0),C("add")},children:e.jsx(ze,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"address",value:x.address||"",onChange:j,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0,readOnly:!0,placeholder:"Click the map icon to select location"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click the map icon to select location automatically"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-white rounded-xl shadow-lg p-4 border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(We,{size:20,className:"text-yellow-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"Farm Information"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Crop Area (hectares)"}),e.jsx("input",{type:"text",name:"cropArea",value:x.cropArea||"",onChange:j,placeholder:"Enter crop area in hectares (e.g., 2.5)",className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all",required:!0})]})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-white rounded-xl shadow-lg p-4 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(ze,{size:20,className:"text-orange-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-orange-800",children:"Lot Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lot Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ze,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"lotNumber",value:x.lotNumber||"",onChange:j,placeholder:"Enter lot number (e.g., Lot 123)",className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lot Area"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(We,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"lotArea",value:x.lotArea||"",onChange:j,placeholder:"Enter lot area (e.g., 1.5 hectares)",className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Agency"}),e.jsx("input",{type:"text",name:"agency",value:x.agency||"",onChange:j,placeholder:"Enter agency name (e.g., DA-PCIC, LGU)",className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 py-2",children:[e.jsx("input",{type:"checkbox",id:"isCertified",name:"isCertified",checked:x.isCertified||!1,onChange:j,className:"w-5 h-5 text-lime-600 rounded focus:ring-lime-500"}),e.jsx("label",{htmlFor:"isCertified",className:"text-gray-700 font-medium",children:"Certified Farmer"})]}),e.jsxs("div",{className:"flex items-center space-x-3 py-2",children:[e.jsx("input",{type:"checkbox",id:"rsbsaRegistered",name:"rsbsaRegistered",checked:x.rsbsaRegistered||!1,onChange:j,className:"w-5 h-5 text-lime-600 rounded focus:ring-lime-500"}),e.jsxs("label",{htmlFor:"rsbsaRegistered",className:"text-gray-700 font-medium",children:["RSBSA Registered ",e.jsx("span",{className:"text-xs text-gray-500",children:"(Required to avail government assistance)"})]})]}),e.jsxs("div",{className:"md:col-span-2 border-t border-gray-200 pt-6 mt-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Re,{className:"mr-2 h-5 w-5 text-lime-600"}),"Farmer Account Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Re,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"username",value:x.username||"",onChange:j,placeholder:"Enter username for farmer login",className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Pe,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"password",name:"password",value:x.password||"",onChange:j,placeholder:"Enter password for farmer login",className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This account will be used by the farmer to access their dashboard and submit claims."})]}),e.jsxs("div",{className:"md:col-span-2 flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>se(!1),className:"flex-1 bg-gray-200 text-gray-800 px-4 py-3 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 bg-lime-700 text-white px-4 py-3 rounded-lg hover:bg-lime-800 transition-colors flex items-center justify-center",children:[e.jsx(Ve,{className:"mr-2 h-5 w-5"}),"Register Farmer"]})]})]})})]})}),ae&&l&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-30 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Farmer Details"}),e.jsx("button",{onClick:()=>oe(!1),className:"text-white hover:text-gray-200 focus:outline-none",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-lime-800 mb-3 flex items-center gap-2",children:[e.jsx(Re,{size:20})," Personal Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Full Name"}),e.jsx("p",{className:"font-medium",children:l.farmerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Birthday"}),e.jsx("p",{className:"font-medium",children:l.birthday||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Gender"}),e.jsx("p",{className:"font-medium",children:l.gender||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Contact Number"}),e.jsx("p",{className:"font-medium",children:l.contactNum||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"font-medium",children:l.address})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Farm Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Type"}),e.jsx("p",{className:"font-medium",children:l.cropType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Area"}),e.jsxs("p",{className:"font-medium",children:[l.cropArea," hectares"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Lot Number"}),e.jsx("p",{className:"font-medium",children:l.lotNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Lot Area"}),e.jsx("p",{className:"font-medium",children:l.lotArea||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Certified"}),e.jsx("p",{className:"font-medium",children:l.isCertified?e.jsxs("span",{className:"text-green-600 flex items-center",children:[e.jsx(Te,{size:16,className:"mr-1"})," Yes"]}):e.jsx("span",{className:"text-gray-600",children:"No"})})]})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-3",children:"Insurance Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Insurance Type"}),e.jsx("p",{className:"font-medium",children:l.insuranceType||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Premium Amount"}),e.jsx("p",{className:"font-medium",children:l.premiumAmount||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Agency"}),e.jsx("p",{className:"font-medium",children:l.agency||"Not provided"})]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>oe(!1),className:"bg-lime-700 text-white px-6 py-2 rounded-lg hover:bg-lime-800 transition",children:"Close"})})]})]})}),Ne&&L&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-30 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 text-gray-800 flex items-center",children:[e.jsx(De,{className:"mr-2 text-red-500",size:24}),"Delete Farmer"]}),e.jsxs("p",{className:"mb-6 text-gray-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:L.farmerName}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{Y(!1),Ce(null)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{try{const n=L._id||L.id;if(!n)throw new Error("No valid farmer ID found");await K.mutateAsync(n),Y(!1),Ce(null),D.getState().addAdminNotification({id:q(),type:"success",title:"Farmer Deleted",message:`${L.farmerName} has been deleted successfully from the database.`,timestamp:new Date}),D.getState().addFarmerNotification({id:q(),type:"warning",title:"Account Deleted",message:"Your account has been deleted by the administrator. Please contact support if you believe this is an error.",timestamp:new Date},n)}catch(n){D.getState().addAdminNotification({id:q(),type:"error",title:"Delete Failed",message:`Failed to delete ${L.farmerName}: ${n.message}`,timestamp:new Date})}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center",children:[e.jsx(ee,{size:16,className:"mr-1"}),"Delete"]})]})]})})]})},Rr=()=>e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(it,{size:24,className:"text-lime-600 mr-2"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Admin Settings"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-800 mb-4 flex items-center",children:[e.jsx(it,{size:18,className:"text-gray-500 mr-2"}),"System Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Email"}),e.jsx("input",{type:"email",className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500",defaultValue:"admin@agriinsurance.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notification Settings"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500",children:[e.jsx("option",{children:"All notifications"}),e.jsx("option",{children:"Important only"}),e.jsx("option",{children:"None"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Language"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500",children:[e.jsx("option",{children:"English"}),e.jsx("option",{children:"Spanish"}),e.jsx("option",{children:"French"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Zone"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500",children:[e.jsx("option",{children:"UTC (Coordinated Universal Time)"}),e.jsx("option",{children:"EST (Eastern Standard Time)"}),e.jsx("option",{children:"PST (Pacific Standard Time)"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-800 mb-4 flex items-center",children:[e.jsx(lt,{size:18,className:"text-gray-500 mr-2"}),"User Management"]}),e.jsxs("button",{className:"bg-lime-600 text-white px-4 py-2 rounded-lg hover:bg-lime-700 transition-colors flex items-center",children:[e.jsx(Ve,{size:18,className:"mr-2"}),"Manage Admin Users"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-800 mb-4 flex items-center",children:[e.jsx(sr,{size:18,className:"text-gray-500 mr-2"}),"Distribution Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Payment Method"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500",children:[e.jsx("option",{children:"Bank Transfer"}),e.jsx("option",{children:"Mobile Money"}),e.jsx("option",{children:"Cash"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Processing Time (Days)"}),e.jsx("input",{type:"number",className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500",defaultValue:"7"})]})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("button",{className:"bg-lime-600 text-white px-6 py-2 rounded-lg hover:bg-lime-700 transition-colors flex items-center",children:[e.jsx(Ut,{size:18,className:"mr-2"}),"Save Settings"]})})]})})]});ys.register(pt,Fs,zs,mt,xt,ut);const Pr=({claims:x=[],searchQuery:Q="",setSearchQuery:m=()=>{},claimsTabView:C="pending",setClaimsTabView:ie=()=>{},showClaimDetails:H=!1,setShowClaimDetails:A=()=>{},selectedClaim:i=null,showConfirmationModal:k=!1,setShowConfirmationModal:W=()=>{},confirmationAction:te={},openClaimDetails:ce=()=>{},initiateStatusUpdate:K=()=>{},confirmStatusUpdate:Z=()=>{}})=>{if(!Array.isArray(x)||x.length===0)return e.jsx("div",{className:"text-center py-10 text-gray-500 italic text-lg",children:"No claims found."});const se=x.filter(d=>{const f=C==="all"?!0:d.status&&d.status.toLowerCase()===C,b=d.name&&d.name.toLowerCase().includes(Q.toLowerCase())||d.crop&&d.crop.toLowerCase().includes(Q.toLowerCase());return f&&(Q.trim()===""||b)});return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Pe,{size:24,className:"text-lime-600 mr-2"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Insurance Claims"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-3 rounded-lg shadow-md border border-yellow-200 h-24",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-yellow-700 font-medium",children:"Pending Claims"}),e.jsx("h3",{className:"text-lg font-bold text-yellow-800",children:x.filter(d=>d.status==="pending").length})]}),e.jsx("div",{className:"p-1.5 bg-yellow-200 rounded-full",children:e.jsx(De,{size:16,className:"text-yellow-700"})})]}),e.jsx("div",{className:"h-1 bg-yellow-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-600 rounded-full transition-all duration-300",style:{width:`${x.filter(d=>d.status==="pending").length/x.length*100}%`}})}),e.jsxs("p",{className:"text-xs text-yellow-700 mt-1 font-medium",children:[x.length>0?(x.filter(d=>d.status==="pending").length/x.length*100).toFixed(1):"0.0","% of total"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-3 rounded-lg shadow-md border border-green-200 h-24",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-700 font-medium",children:"Approved Claims"}),e.jsx("h3",{className:"text-lg font-bold text-green-800",children:x.filter(d=>d.status==="approved").length})]}),e.jsx("div",{className:"p-1.5 bg-green-200 rounded-full",children:e.jsx(Te,{size:16,className:"text-green-700"})})]}),e.jsx("div",{className:"h-1 bg-green-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-600 rounded-full transition-all duration-300",style:{width:`${x.filter(d=>d.status==="approved").length/x.length*100}%`}})}),e.jsxs("p",{className:"text-xs text-green-700 mt-1 font-medium",children:[x.length>0?(x.filter(d=>d.status==="approved").length/x.length*100).toFixed(1):"0.0","% of total"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-3 rounded-lg shadow-md border border-red-200 h-24",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-700 font-medium",children:"Rejected Claims"}),e.jsx("h3",{className:"text-lg font-bold text-red-800",children:x.filter(d=>d.status==="rejected").length})]}),e.jsx("div",{className:"p-1.5 bg-red-200 rounded-full",children:e.jsx(hs,{size:16,className:"text-red-700"})})]}),e.jsx("div",{className:"h-1 bg-red-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-600 rounded-full transition-all duration-300",style:{width:`${x.filter(d=>d.status==="rejected").length/x.length*100}%`}})}),e.jsxs("p",{className:"text-xs text-red-700 mt-1 font-medium",children:[x.length>0?(x.filter(d=>d.status==="rejected").length/x.length*100).toFixed(1):"0.0","% of total"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(tr,{size:20,className:"text-emerald-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Status Comparison Over Time"})]}),e.jsx("div",{className:"h-[400px]",children:e.jsx(ct,{data:(()=>{const d=new Date().getFullYear(),b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((u,y)=>{const B=x.filter(q=>{const l=new Date(q.date);return l.getFullYear()===d&&l.getMonth()===y});return{month:u,pending:B.filter(q=>q.status==="pending").length,approved:B.filter(q=>q.status==="approved").length,rejected:B.filter(q=>q.status==="rejected").length}});return{labels:b.map(u=>u.month),datasets:[{label:"Pending",data:b.map(u=>u.pending),backgroundColor:"rgba(251, 191, 36, 0.8)",borderColor:"rgba(251, 191, 36, 1)",borderWidth:1},{label:"Approved",data:b.map(u=>u.approved),backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:1},{label:"Rejected",data:b.map(u=>u.rejected),backgroundColor:"rgba(239, 68, 68, 0.8)",borderColor:"rgba(239, 68, 68, 1)",borderWidth:1}]}})(),options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,pointStyle:"rect",padding:20,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#10b981",borderWidth:1,callbacks:{label:function(d){const f=d.dataset.label||"",b=d.parsed.y;return`${f}: ${b} claims`}}}},scales:{x:{title:{display:!0,text:"Month",font:{size:14,weight:"bold"}},grid:{display:!1}},y:{title:{display:!0,text:"Number of Claims",font:{size:14,weight:"bold"}},beginAtZero:!0,grid:{display:!1}}}}})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ar,{size:20,className:"text-emerald-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Claims Distribution"})]}),e.jsxs("div",{className:"relative",style:{height:"400px"},children:[e.jsx(Ls,{data:{labels:["Pending","Approved","Rejected"],datasets:[{data:[x.filter(d=>d.status==="pending").length,x.filter(d=>d.status==="approved").length,x.filter(d=>d.status==="rejected").length],backgroundColor:["rgba(251, 191, 36, 0.8)","rgba(34, 197, 94, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:["rgba(251, 191, 36, 1)","rgba(34, 197, 94, 1)","rgba(239, 68, 68, 1)"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:15,font:{size:11},color:"#1e40af"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#3b82f6",borderWidth:1,callbacks:{label:function(d){const f=d.label||"",b=d.raw||0,u=d.dataset.data.reduce((B,q)=>B+q,0),y=u>0?(b/u*100).toFixed(1):"0.0";return`${f}: ${b} (${y}%)`}}}},cutout:"70%"}}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsx("div",{className:"text-3xl font-bold text-gray-800",children:x.length}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Total Claims"})]})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>ie("pending"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${C==="pending"?"bg-lime-100 text-lime-800":"text-gray-600 hover:bg-gray-100"}`,children:"Pending Claims"}),e.jsx("button",{onClick:()=>ie("approved"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${C==="approved"?"bg-green-100 text-green-800":"text-gray-600 hover:bg-gray-100"}`,children:"Approved Claims"}),e.jsx("button",{onClick:()=>ie("rejected"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${C==="rejected"?"bg-red-100 text-red-800":"text-gray-600 hover:bg-gray-100"}`,children:"Rejected Claims"})]})})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 gap-4",children:[e.jsxs("h3",{className:"text-lg font-medium",children:[C==="pending"&&"Pending Claims",C==="approved"&&"Approved Claims",C==="rejected"&&"Rejected Claims"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Je,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search by name or crop...",value:Q,onChange:d=>m(d.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full md:w-64 shadow-sm focus:outline-none focus:ring-2 focus:ring-lime-500"})]})]}),se.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(Pe,{size:48,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-500 italic",children:"No claims available matching your filters."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-separate border-spacing-y-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 bg-gray-50 rounded-l-lg font-semibold text-gray-600",children:"Claim ID"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Farmer Name"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Crop Type"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Date"}),e.jsx("th",{className:"p-3 bg-gray-50 font-semibold text-gray-600",children:"Status"}),e.jsx("th",{className:"p-3 bg-gray-50 rounded-r-lg font-semibold text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{children:se.sort((d,f)=>{const b=new Date(f.date)-new Date(d.date);if(b===0){const u=Number.parseFloat(d.degreeOfDamage)||Number.parseFloat(d.areaDamaged)||0;return(Number.parseFloat(f.degreeOfDamage)||Number.parseFloat(d.areaDamaged)||0)-u}return b}).map(d=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 border-b border-gray-200 font-medium",children:d.claimNumber||d._id}),e.jsx("td",{className:"p-3 border-b border-gray-200",children:d.name}),e.jsx("td",{className:"p-3 border-b border-gray-200",children:d.crop||d.cropType||"Unknown"}),e.jsx("td",{className:"p-3 border-b border-gray-200",children:new Date(d.date).toLocaleDateString()}),e.jsx("td",{className:"p-3 border-b border-gray-200 capitalize",children:e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium inline-flex items-center
                          ${d.status==="approved"?"bg-green-100 text-lime-800":d.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[d.status==="approved"&&e.jsx(Te,{size:12,className:"mr-1"}),d.status==="pending"&&e.jsx(De,{size:12,className:"mr-1"}),d.status==="rejected"&&e.jsx(hs,{size:12,className:"mr-1"}),d.status.charAt(0).toUpperCase()+d.status.slice(1)]})}),e.jsxs("td",{className:"p-3 border-b border-gray-200 space-x-2",children:[e.jsx("button",{onClick:()=>ce(d),className:"text-blue-600 hover:text-blue-800 font-medium",children:"View"}),d.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>K(d._id,"approved",d.farmerId),className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-lime-700 text-sm inline-flex items-center",children:[e.jsx(Te,{size:14,className:"mr-1"}),"Approve"]}),e.jsxs("button",{onClick:()=>K(d._id,"rejected",d.farmerId),className:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 text-sm inline-flex items-center",children:[e.jsx(hs,{size:14,className:"mr-1"}),"Reject"]})]})]})]},d._id))})]})})]}),H&&i&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Claim Details"}),e.jsx("button",{onClick:()=>A(!1),className:"text-white hover:text-gray-200 focus:outline-none transition-colors",children:e.jsx(hs,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-lime-800 mb-3 flex items-center gap-2",children:[e.jsx(Re,{size:20}),"Basic Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Claim ID"}),e.jsx("p",{className:"font-medium",children:i.claimNumber||i._id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Farmer Name"}),e.jsx("p",{className:"font-medium",children:i.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"font-medium",children:i.address||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Phone"}),e.jsx("p",{className:"font-medium",children:i.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Date Filed"}),e.jsx("p",{className:"font-medium",children:new Date(i.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Status"}),e.jsx("p",{className:`font-medium ${i.status==="approved"?"text-green-600":i.status==="pending"?"text-yellow-600":"text-red-600"}`,children:i.status.charAt(0).toUpperCase()+i.status.slice(1)})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Crop Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Type"}),e.jsx("p",{className:"font-medium",children:i.crop})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Area Insured"}),e.jsxs("p",{className:"font-medium",children:[i.areaInsured," hectares"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Area Damaged"}),e.jsxs("p",{className:"font-medium",children:[i.areaDamaged," hectares"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Degree of Damage"}),e.jsxs("p",{className:"font-medium",children:[i.degreeOfDamage,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Program"}),e.jsx("p",{className:"font-medium",children:i.program&&i.program.length>0?i.program.join(", "):"Not specified"})]})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-lime-800 mb-3",children:"Additional Crop Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Variety Planted"}),e.jsx("p",{className:"font-medium",children:i.varietyPlanted||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Planting Date"}),e.jsx("p",{className:"font-medium",children:i.plantingDate?new Date(i.plantingDate).toLocaleDateString():"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"CIC Number"}),e.jsx("p",{className:"font-medium",children:i.cicNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Underwriter"}),e.jsx("p",{className:"font-medium",children:i.underwriter||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Farmer Location"}),e.jsx("p",{className:"font-medium",children:i.farmerLocation||"Not provided"})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:[e.jsx(De,{size:20}),"Damage Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Cause of Loss"}),e.jsx("p",{className:"font-medium",children:i.damageType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Date of Loss"}),e.jsx("p",{className:"font-medium",children:i.lossDate?new Date(i.lossDate).toLocaleDateString():"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Age/Stage at Time of Loss"}),e.jsx("p",{className:"font-medium",children:i.ageStage||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Expected Harvest"}),e.jsx("p",{className:"font-medium",children:i.expectedHarvest?`${i.expectedHarvest} tons`:"Not provided"})]})]})]}),i.damagePhotos&&i.damagePhotos.length>0&&e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-orange-800 mb-3 flex items-center gap-2",children:["📷 Damage Evidence Photos (",i.damagePhotos.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:i.damagePhotos.map((d,f)=>typeof d=="string"&&d.startsWith("data:")?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:d,alt:`Damage evidence ${f+1}`,className:"w-full h-32 object-cover rounded-lg border cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>{const u=document.createElement("div");u.className="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4",u.innerHTML=`
                                <div class="relative max-w-4xl max-h-full">
                                  <img src="${d}" alt="Damage evidence ${f+1}" class="max-w-full max-h-full object-contain" />
                                  <button class="absolute top-4 right-4 bg-white bg-opacity-20 text-white p-2 rounded-full hover:bg-opacity-30 transition-colors" onclick="this.parentElement.parentElement.remove()">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                  </button>
                                </div>
                              `,document.body.appendChild(u),u.addEventListener("click",y=>{y.target===u&&u.remove()})}}),e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:["Photo ",f+1]})]},f):e.jsx("div",{className:"relative group",children:e.jsx("div",{className:"w-full h-32 bg-gray-200 rounded-lg border flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Pe,{className:"h-8 w-8 text-gray-400 mx-auto mb-1"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Photo ",f+1]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Not available"})]})})},f))}),e.jsx("p",{className:"text-sm text-orange-700 mt-3",children:"Click on any photo to view it in full size"})]}),i.adminFeedback&&e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-purple-800 mb-3 flex items-center gap-2",children:[e.jsx(Wt,{size:20}),"Admin Feedback"]}),e.jsx("div",{className:"bg-white p-3 rounded border border-purple-100",children:e.jsx("p",{className:"text-gray-700",children:i.adminFeedback})})]}),i.lotBoundaries&&Object.keys(i.lotBoundaries).length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Location Sketch Information"}),e.jsx("div",{className:"space-y-4",children:Object.keys(i.lotBoundaries).map(d=>e.jsxs("div",{className:"border border-blue-100 p-3 rounded bg-white",children:[e.jsxs("h4",{className:"font-medium text-blue-700 mb-2",children:["Lot ",d]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"North"}),e.jsx("p",{className:"text-sm",children:i.lotBoundaries[d].north||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"South"}),e.jsx("p",{className:"text-sm",children:i.lotBoundaries[d].south||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"East"}),e.jsx("p",{className:"text-sm",children:i.lotBoundaries[d].east||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"West"}),e.jsx("p",{className:"text-sm",children:i.lotBoundaries[d].west||"Not specified"})]})]})]},d))})]}),i.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:"💰 Compensation Preview"}),(()=>{const d=dt(Number.parseFloat((i==null?void 0:i.areaDamaged)||0),Number.parseFloat((i==null?void 0:i.degreeOfDamage)||0),(i==null?void 0:i.crop)||"Other",(i==null?void 0:i.damageType)||"Other"),f=Vt(Number.parseFloat((i==null?void 0:i.degreeOfDamage)||0)),b=Jt((i==null?void 0:i.crop)||"Other");return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-white p-3 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Estimated Compensation:"}),e.jsxs("span",{className:"text-2xl font-bold text-green-700",children:["₱",d.finalCompensation.toLocaleString()]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Damage Severity"}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-sm font-medium ${f.bgColor} ${f.color}`,children:f.level})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Coverage Type"}),e.jsx("p",{className:"font-medium text-sm",children:b.coverage})]})]})]})})()]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsxs("button",{onClick:()=>K(i._id,"rejected",i.farmerId),className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition flex items-center",children:[e.jsx(hs,{size:18,className:"mr-2"}),"Reject Claim"]}),e.jsxs("button",{onClick:()=>K(i._id,"approved",i.farmerId),className:"bg-lime-600 text-white px-6 py-2 rounded-lg hover:bg-lime-700 transition flex items-center",children:[e.jsx(Te,{size:18,className:"mr-2"}),"Approve Claim"]})]})]}),i.status==="approved"&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-3",children:"Insurance Compensation Details"}),(()=>{const d=dt(Number.parseFloat((i==null?void 0:i.areaDamaged)||0),Number.parseFloat((i==null?void 0:i.degreeOfDamage)||0),(i==null?void 0:i.crop)||"Other",(i==null?void 0:i.damageType)||"Other"),f=Tr(i==null?void 0:i.completionDate);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Final Compensation"}),e.jsxs("p",{className:"font-bold text-2xl text-green-700",children:["₱",d.finalCompensation.toLocaleString()]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${f.bgColor} ${f.statusColor}`,children:f.status})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-green-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Payment Status"}),e.jsx("p",{className:`font-medium ${f.statusColor}`,children:f.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f.message})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-green-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Expected Payment Date"}),e.jsx("p",{className:"font-medium",children:$r(i==null?void 0:i.completionDate)})]})]})]})})()]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>A(!1),className:"bg-lime-700 text-white px-6 py-2 rounded-lg hover:bg-lime-800 transition",children:"Close"})})]})]})}),k&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:te.type==="approved"?"Approve Claim":"Reject Claim"}),e.jsxs("p",{className:"mb-6 text-gray-600",children:["Are you sure you want to ",te.type==="approved"?"approve":"reject"," this claim? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Z,className:`px-4 py-2 rounded-lg text-white transition-colors ${te.type==="approved"?"bg-lime-600 hover:bg-lime-700":"bg-red-600 hover:bg-red-700"}`,children:te.type==="approved"?"Yes, Approve":"Yes, Reject"})]})]})})]})},Mr=({showModal:x,setShowModal:Q,modalForm:m,setModalForm:C,initialModalForm:ie,selectedLocation:H,setSelectedLocation:A,setShowMapModal:i,setMapMode:k,setFarmers:W,showEventModal:te,setShowEventModal:ce,eventForm:K,handleEventChange:Z,handleEventSubmit:se,showRegisterForm:d,setShowRegisterForm:f,formData:b,handleChange:u,handleSubmit:y,showClaimDetails:B,setShowClaimDetails:q,selectedClaim:l,initiateStatusUpdate:P,showConfirmationModal:ae,setShowConfirmationModal:oe,confirmationAction:L,confirmStatusUpdate:Ce,feedbackText:Ne,setFeedbackText:Y,showMapModal:ve,mapMode:ke,mapSearchQuery:$e,setMapSearchQuery:qe,searchLocation:p,mapRef:j,showFarmerDetails:S,setShowFarmerDetails:de,selectedFarmer:n,showDeleteConfirmation:h,setShowDeleteConfirmation:I,farmerToDelete:V,setFarmerToDelete:F,farmers:G})=>{const re=`
    /* Hide scrollbar but maintain functionality */
    .hide-scrollbar {
      -ms-overflow-style: none;  /* IE and Edge */
      scrollbar-width: none;  /* Firefox */
    }
    .hide-scrollbar::-webkit-scrollbar {
      display: none;  /* Chrome, Safari and Opera */
    }
  `,X={...m,isCertified:typeof m.isCertified=="boolean"?m.isCertified:!1};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:re}),x&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-red-600 text-xl font-bold",onClick:()=>Q(!1),children:"×"}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Register Farmer"})]}),e.jsxs("form",{onSubmit:c=>{c.preventDefault();const T=JSON.parse(localStorage.getItem("farmers")||"[]");if(T.some(Ke=>Ke.username===m.username)){alert("Username already exists. Please choose a different username.");return}if(!m.username||!m.password){alert("Username and password are required.");return}const me={id:Date.now().toString(),farmerName:`${m.firstName} ${m.middleName} ${m.lastName}`.trim(),address:m.address,cropType:m.cropType,cropArea:m.cropArea,farmName:m.farmName,insuranceType:m.insuranceType,premiumAmount:m.premiumAmount,lotNumber:m.lotNumber,lotArea:m.lotArea,agency:m.agency,isCertified:m.isCertified,periodFrom:m.periodFrom,periodTo:m.periodTo,birthday:m.birthday,gender:m.gender,contactNum:m.contactNum,location:H,username:m.username,password:m.password,rsbsaRegistered:!!m.rsbsaRegistered},ue=[...T,me];localStorage.setItem("farmers",JSON.stringify(ue)),W(ue),C(ie),A(null),Q(!1),alert("Farmer registered successfully!")},className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-6",children:[e.jsx("input",{type:"text",placeholder:"First Name",value:m.firstName,onChange:c=>C({...m,firstName:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"text",placeholder:"Middle Name",value:m.middleName,onChange:c=>C({...m,middleName:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",placeholder:"Last Name",value:m.lastName,onChange:c=>C({...m,lastName:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"date",placeholder:"Birthday",value:m.birthday,onChange:c=>C({...m,birthday:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsxs("select",{value:m.gender,onChange:c=>C({...m,gender:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]}),e.jsx("input",{type:"tel",placeholder:"Contact Number",value:m.contactNum,onChange:c=>C({...m,contactNum:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"text",placeholder:"Username",value:m.username||"",onChange:c=>C({...m,username:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"password",placeholder:"Password",value:m.password||"",onChange:c=>C({...m,password:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsxs("div",{className:"flex items-center space-x-2 md:col-span-2",children:[e.jsx("input",{type:"checkbox",checked:!!m.rsbsaRegistered,onChange:c=>C({...m,rsbsaRegistered:c.target.checked})}),e.jsxs("label",{children:["RSBSA Registered ",e.jsx("span",{className:"text-xs text-gray-500",children:"(Required to avail government assistance)"})]})]}),e.jsx("input",{type:"text",placeholder:"Address",value:m.address,onChange:c=>C({...m,address:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"text",placeholder:"Crop Type",value:m.cropType,onChange:c=>C({...m,cropType:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"text",placeholder:"Crop Area (hectares)",value:m.cropArea,onChange:c=>C({...m,cropArea:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"text",placeholder:"Farm Name",value:m.farmName,onChange:c=>C({...m,farmName:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"}),e.jsxs("select",{value:m.insuranceType,onChange:c=>C({...m,insuranceType:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",children:[e.jsx("option",{value:"",children:"Select Insurance Type"}),e.jsx("option",{value:"Crop Damage",children:"Crop Damage"}),e.jsx("option",{value:"Flood",children:"Flood"}),e.jsx("option",{value:"Pest",children:"Pest"})]}),e.jsx("input",{type:"number",placeholder:"Premium Amount",value:m.premiumAmount,onChange:c=>C({...m,premiumAmount:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",placeholder:"Lot Number",value:m.lotNumber,onChange:c=>C({...m,lotNumber:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",placeholder:"Lot Area",value:m.lotArea,onChange:c=>C({...m,lotArea:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"}),e.jsx("input",{type:"text",placeholder:"Agency",value:m.agency,onChange:c=>C({...m,agency:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!!X.isCertified,onChange:c=>C({...m,isCertified:c.target.checked})}),e.jsx("label",{children:"Certified"})]}),e.jsx("input",{type:"date",value:m.periodFrom,onChange:c=>C({...m,periodFrom:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("input",{type:"date",value:m.periodTo,onChange:c=>C({...m,periodTo:c.target.value}),className:"border border-gray-300 p-2.5 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("button",{type:"button",onClick:()=>{i(!0),k("add")},className:"bg-lime-600 text-white px-4 py-2 rounded-lg hover:bg-lime-700 transition-colors flex items-center justify-center shadow-sm",children:[e.jsx(ze,{className:"mr-2 h-5 w-5"}),H?"Change Farm Location":"Add Farm Location"]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("button",{type:"submit",className:"bg-lime-700 text-white px-4 py-2 rounded hover:bg-lime-600 w-full",children:"Submit"})})]})]})}),te&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-lime-800",children:"Add Government Assistance"}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Assistance Type"}),e.jsxs("select",{name:"assistanceType",value:K.assistanceType||"",onChange:Z,className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700",required:!0,children:[e.jsx("option",{value:"",children:"Select Assistance Type"}),e.jsx("option",{value:"Seed Distribution",children:"🌱 Seed Distribution"}),e.jsx("option",{value:"Fertilizer Subsidy",children:"💊 Fertilizer Subsidy"}),e.jsx("option",{value:"Machinery Support",children:"🚜 Machinery Support"}),e.jsx("option",{value:"Cash Assistance",children:"💸 Cash Assistance"}),e.jsx("option",{value:"Food Packs",children:"📦 Food Packs"}),e.jsx("option",{value:"Training & Tools",children:"🧪 Training & Tools"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{name:"description",value:K.description||"",onChange:Z,className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700",required:!0,placeholder:"Describe the assistance (e.g., variety, details, etc.)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Crop Type"}),e.jsxs("select",{name:"cropType",value:K.cropType,onChange:Z,className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700",required:!0,children:[e.jsx("option",{value:"",children:"Select Crop Type"}),e.jsx("option",{value:"Rice",children:"Rice"}),e.jsx("option",{value:"Corn",children:"Corn"}),e.jsx("option",{value:"Vegetables",children:"Vegetables"}),e.jsx("option",{value:"Banana",children:"Banana"}),e.jsx("option",{value:"Coconut",children:"Coconut"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),K.cropType==="Other"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Specify Crop Type"}),e.jsx("input",{type:"text",name:"otherCropType",value:K.otherCropType||"",onChange:Z,className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700",required:!0,placeholder:"Enter crop type"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Founder Name"}),e.jsx("input",{type:"text",name:"founderName",value:K.founderName,onChange:Z,className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),e.jsx("input",{type:"number",name:"quantity",value:K.quantity,onChange:Z,className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700",required:!0,min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date Added"}),e.jsx("input",{type:"date",name:"dateAdded",value:K.dateAdded,onChange:Z,className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Photo/Logo"}),e.jsx("input",{type:"file",name:"photo",accept:"image/*",onChange:c=>{const T=c.target.files&&c.target.files[0];if(T){const me=new FileReader;me.onload=ue=>{Z({target:{name:"photo",value:ue.target.result,type:"text"}})},me.readAsDataURL(T)}},className:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 text-gray-700"}),K.photo&&e.jsx("img",{src:K.photo,alt:"Preview",className:"mt-2 h-20 object-contain rounded border"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>ce(!1),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-lime-700 text-white rounded hover:bg-lime-600",children:"Save"})]})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-5 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Register a New Farmer"}),e.jsx("button",{className:"text-white hover:text-gray-200 focus:outline-none",onClick:()=>f(!1),children:e.jsx(ee,{size:24})})]}),e.jsx("div",{className:"p-6 md:p-8",children:e.jsxs("form",{onSubmit:y,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Re,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"firstName",value:b.firstName,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Middle Name"}),e.jsx("input",{type:"text",name:"middleName",value:b.middleName,onChange:u,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:b.lastName,onChange:u,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Birthday"}),e.jsx("input",{type:"date",name:"birthday",value:b.birthday,onChange:u,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Gender"}),e.jsxs("select",{name:"gender",value:b.gender,onChange:u,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Number"}),e.jsx("input",{type:"tel",name:"contactNum",value:b.contactNum,onChange:u,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ze,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"address",value:b.address,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Crop Type"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(We,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"cropType",value:b.cropType,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Crop Area (hectares)"}),e.jsx("input",{type:"text",name:"cropArea",value:b.cropArea,onChange:u,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Insurance Type"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Pe,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"insuranceType",value:b.insuranceType,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Premium Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Mt,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"number",name:"premiumAmount",value:b.premiumAmount,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lot Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ze,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"lotNumber",value:b.lotNumber,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lot Area"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(We,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"lotArea",value:b.lotArea,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Agency"}),e.jsx("input",{type:"text",name:"agency",value:b.agency,onChange:u,className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{className:"flex items-center space-x-3 py-2",children:[e.jsx("input",{type:"checkbox",id:"isCertified",name:"isCertified",checked:b.isCertified,onChange:u,className:"w-5 h-5 text-lime-600 rounded focus:ring-lime-500"}),e.jsx("label",{htmlFor:"isCertified",className:"text-gray-700 font-medium",children:"Certified Farmer"})]}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Period From"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ot,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"date",name:"periodFrom",value:b.periodFrom,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Period To"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ot,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"date",name:"periodTo",value:b.periodTo,onChange:u,className:"pl-10 w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-transparent transition-all",required:!0})]})]})]}),e.jsx("div",{className:"md:col-span-2 pt-4",children:e.jsxs("button",{type:"button",onClick:()=>{i(!0),k("add")},className:"bg-lime-600 text-white px-4 py-3 rounded-lg hover:bg-lime-700 transition-colors flex items-center justify-center shadow-sm w-full mb-4",children:[e.jsx(ze,{className:"mr-2 h-5 w-5"}),H?"Change Farm Location":"Add Farm Location"]})}),e.jsxs("div",{className:"md:col-span-2 flex gap-4 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"flex-1 bg-gray-200 text-gray-800 px-4 py-3 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 bg-lime-700 text-white px-4 py-3 rounded-lg hover:bg-lime-800 transition-colors flex items-center justify-center",children:[e.jsx(Ve,{className:"mr-2 h-5 w-5"}),"Register Farmer"]})]})]})})]})}),B&&l&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Claim Details"}),e.jsx("button",{onClick:()=>q(!1),className:"text-white hover:text-gray-200 focus:outline-none transition-colors",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-lime-800 mb-3 flex items-center gap-2",children:[e.jsx(Qt,{size:20}),"Basic Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Claim ID"}),e.jsx("p",{className:"font-medium",children:l.claimNumber||l.id||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Farmer Name"}),e.jsx("p",{className:"font-medium",children:l.name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"font-medium",children:l.address||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Phone"}),e.jsx("p",{className:"font-medium",children:l.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Farmer Location"}),e.jsx("p",{className:"font-medium",children:l.farmerLocation||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Date Filed"}),e.jsx("p",{className:"font-medium",children:new Date(l.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Status"}),e.jsx("p",{className:`font-medium ${l.status==="approved"?"text-green-600":l.status==="pending"?"text-yellow-600":"text-red-600"}`,children:l.status.charAt(0).toUpperCase()+l.status.slice(1)})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Crop Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Type"}),e.jsx("p",{className:"font-medium",children:l.crop||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Area Insured"}),e.jsx("p",{className:"font-medium",children:l.areaInsured?`${l.areaInsured} hectares`:"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Area Damaged"}),e.jsx("p",{className:"font-medium",children:l.areaDamaged?`${l.areaDamaged} hectares`:"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Degree of Damage"}),e.jsx("p",{className:"font-medium",children:l.degreeOfDamage?`${l.degreeOfDamage}%`:"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Program"}),e.jsx("p",{className:"font-medium",children:l.program&&l.program.length>0?l.program.join(", "):l.otherProgramText||"Not specified"})]})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-lime-800 mb-3",children:"Additional Crop Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Variety Planted"}),e.jsx("p",{className:"font-medium",children:l.varietyPlanted||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Planting Date"}),e.jsx("p",{className:"font-medium",children:l.plantingDate?new Date(l.plantingDate).toLocaleDateString():"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"CIC Number"}),e.jsx("p",{className:"font-medium",children:l.cicNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Underwriter"}),e.jsx("p",{className:"font-medium",children:l.underwriter||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Farmer Location"}),e.jsx("p",{className:"font-medium",children:l.farmerLocation||"Not provided"})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:[e.jsx(De,{size:20}),"Damage Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Cause of Loss"}),e.jsx("p",{className:"font-medium",children:l.damageType||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Date of Loss"}),e.jsx("p",{className:"font-medium",children:l.lossDate?new Date(l.lossDate).toLocaleDateString():"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Age/Stage at Time of Loss"}),e.jsx("p",{className:"font-medium",children:l.ageStage||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Expected Harvest"}),e.jsx("p",{className:"font-medium",children:l.expectedHarvest?`${l.expectedHarvest} tons`:"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Area Damaged"}),e.jsx("p",{className:"font-medium",children:l.areaDamaged?`${l.areaDamaged} hectares`:"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Degree of Damage"}),e.jsx("p",{className:"font-medium",children:l.degreeOfDamage?`${l.degreeOfDamage}%`:"Not provided"})]})]})]}),l.damagePhotos&&l.damagePhotos.length>0&&e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-orange-800 mb-3 flex items-center gap-2",children:[e.jsx(rr,{size:20}),"Damage Evidence Photos (",l.damagePhotos.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:l.damagePhotos.map((c,T)=>typeof c=="string"&&c.startsWith("data:")?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:c,alt:`Damage evidence ${T+1}`,className:"w-full h-32 object-cover rounded-lg border cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>{const ue=document.createElement("div");ue.className="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4",ue.innerHTML=`
                                <div class="relative max-w-4xl max-h-full">
                                  <img src="${c}" alt="Damage evidence ${T+1}" class="max-w-full max-h-full object-contain" />
                                  <button class="absolute top-4 right-4 bg-white bg-opacity-20 text-white p-2 rounded-full hover:bg-opacity-30 transition-colors" onclick="this.parentElement.parentElement.remove()">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                  </button>
                                </div>
                              `,document.body.appendChild(ue),ue.addEventListener("click",Ke=>{Ke.target===ue&&ue.remove()})}}),e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:["Photo ",T+1]})]},T):e.jsx("div",{className:"relative group",children:e.jsx("div",{className:"w-full h-32 bg-gray-200 rounded-lg border flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Pe,{className:"h-8 w-8 text-gray-400 mx-auto mb-1"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Photo ",T+1]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Not available"})]})})},T))}),e.jsx("p",{className:"text-sm text-orange-700 mt-3",children:"Click on any photo to view it in full size"})]}),l.lotBoundaries&&Object.keys(l.lotBoundaries).length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Location Sketch Information"}),e.jsx("div",{className:"space-y-4",children:Object.keys(l.lotBoundaries).map(c=>e.jsxs("div",{className:"border border-blue-100 p-3 rounded bg-white",children:[e.jsxs("h4",{className:"font-medium text-blue-700 mb-2",children:["Lot ",c]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"North"}),e.jsx("p",{className:"text-sm",children:l.lotBoundaries[c].north||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"South"}),e.jsx("p",{className:"text-sm",children:l.lotBoundaries[c].south||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"East"}),e.jsx("p",{className:"text-sm",children:l.lotBoundaries[c].east||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"West"}),e.jsx("p",{className:"text-sm",children:l.lotBoundaries[c].west||"Not specified"})]})]})]},c))})]}),l.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:[e.jsx(Mt,{size:20}),"Compensation Preview"]}),(()=>{const c=dt(Number.parseFloat((l==null?void 0:l.areaDamaged)||0),Number.parseFloat((l==null?void 0:l.degreeOfDamage)||0),(l==null?void 0:l.crop)||"Other",(l==null?void 0:l.damageType)||"Other"),T=Vt(Number.parseFloat((l==null?void 0:l.degreeOfDamage)||0)),me=Jt((l==null?void 0:l.crop)||"Other");return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-white p-3 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Estimated Compensation:"}),e.jsxs("span",{className:"text-2xl font-bold text-green-700",children:["₱",c.finalCompensation.toLocaleString()]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Damage Severity"}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-sm font-medium ${T.bgColor} ${T.color}`,children:T.level})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Coverage Type"}),e.jsx("p",{className:"font-medium text-sm",children:me.coverage})]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-yellow-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Calculation Summary"}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1 space-y-1",children:[e.jsxs("div",{children:["Base Rate: ₱",c.cropRate.toLocaleString(),"/hectare"]}),e.jsxs("div",{children:["Damage Multiplier: ",c.damageMultiplier,"x"]}),e.jsxs("div",{children:["Base Calculation: ₱",c.baseCompensation.toLocaleString()]}),e.jsxs("div",{className:"font-medium text-green-700",children:["Final Amount: ₱",c.finalCompensation.toLocaleString()]})]})]})]})})()]}),e.jsxs("div",{className:"mt-6 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Feedback (Optional)"}),e.jsx("textarea",{value:Ne,onChange:c=>Y(c.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lime-500 focus:border-lime-500",rows:2,placeholder:"Add notes or feedback for the farmer..."})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsxs("button",{onClick:()=>P(l._id||l.id,"rejected",l.farmerId),className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition flex items-center",children:[e.jsx(nr,{size:18,className:"mr-2"}),"Reject Claim"]}),e.jsxs("button",{onClick:()=>P(l._id||l.id,"approved",l.farmerId),className:"bg-lime-600 text-white px-6 py-2 rounded-lg hover:bg-lime-700 transition flex items-center",children:[e.jsx(lr,{size:18,className:"mr-2"}),"Approve Claim"]})]})]}),l.status==="approved"&&l.compensation&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-3 flex items-center gap-2",children:[e.jsx(Te,{size:20}),"Approved Compensation"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-white p-3 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Final Compensation:"}),e.jsxs("span",{className:"text-2xl font-bold text-green-700",children:["₱",l.compensation.toLocaleString()]})]})}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-green-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Approval Date"}),e.jsx("p",{className:"font-medium",children:l.completionDate?new Date(l.completionDate).toLocaleDateString():"Not specified"})]}),l.adminFeedback&&e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-green-200",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Admin Feedback"}),e.jsx("p",{className:"font-medium text-sm",children:l.adminFeedback})]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>{q(!1),D.getState().addAdminNotification({id:`close-claim-${l._id||l.id}`,type:"info",title:"Claim Details Closed",message:`Finished reviewing claim from ${l.name}.`,timestamp:new Date})},className:"bg-lime-700 text-white px-6 py-2 rounded-lg hover:bg-lime-800 transition",children:"Close"})})]})]})}),ae&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:L.type==="approved"?"Approve Claim":"Reject Claim"}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["Are you sure you want to ",L.type==="approved"?"approve":"reject"," this claim? This action cannot be undone."]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:L.type==="approved"?"Approval Notes (Optional)":"Rejection Reason (Optional)"}),e.jsx("textarea",{value:Ne,onChange:c=>Y(c.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lime-500 focus:border-lime-500",rows:3,placeholder:L.type==="approved"?"Add any notes for the farmer...":"Provide reason for rejection..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>oe(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Ce,className:`px-4 py-2 rounded-lg text-white transition-colors ${L.type==="approved"?"bg-lime-600 hover:bg-lime-700":"bg-red-600 hover:bg-red-700"}`,children:L.type==="approved"?"Yes, Approve":"Yes, Reject"})]})]})}),ve&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:ke==="view"?"Farm Locations Map":"Select Farm Location"}),e.jsx("button",{onClick:()=>i(!1),className:"text-white hover:text-gray-200 focus:outline-none",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-4 border-b border-gray-200 flex flex-wrap gap-4 items-center",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search for a location...",value:$e,onChange:c=>qe(c.target.value),className:"w-full p-2 pr-10 border rounded-md",onKeyDown:c=>{c.key==="Enter"&&p()}}),e.jsx("button",{onClick:p,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx(Je,{className:"h-5 w-5"})})]})}),ke==="view"&&e.jsxs("button",{onClick:()=>k("add"),className:"bg-lime-600 text-white px-4 py-2 rounded hover:bg-lime-700 flex items-center",children:[e.jsx(is,{className:"mr-2 h-5 w-5"}),"Add Location"]}),ke==="add"&&e.jsxs("button",{onClick:()=>k("view"),className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 flex items-center",children:[e.jsx(We,{className:"mr-2 h-5 w-5"}),"View All Locations"]})]}),e.jsx("div",{className:"flex-1 min-h-[400px] relative",children:e.jsx("div",{ref:j,className:"w-full h-[500px]"})}),ke==="add"&&e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:H?e.jsxs("p",{className:"text-sm text-gray-600",children:["Selected coordinates: ",H.lat.toFixed(6),", ",H.lng.toFixed(6)]}):e.jsx("p",{className:"text-sm text-gray-600",children:"Click on the map to select a location"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{onClick:()=>{H?i(!1):alert("Please select a location on the map first.")},disabled:!H,className:`px-4 py-2 bg-lime-700 text-white rounded hover:bg-lime-800 ${H?"":"opacity-50 cursor-not-allowed"}`,children:"Confirm Location"})]})]})})]})}),S&&n&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Farmer Details"}),e.jsx("button",{onClick:()=>de(!1),className:"text-white hover:text-gray-200 focus:outline-none transition-colors",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-lime-800 mb-3 flex items-center gap-2",children:[e.jsx(Re,{size:20}),"Personal Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Full Name"}),e.jsx("p",{className:"font-medium",children:n.farmerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Birthday"}),e.jsx("p",{className:"font-medium",children:n.birthday||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Gender"}),e.jsx("p",{className:"font-medium",children:n.gender||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Contact Number"}),e.jsx("p",{className:"font-medium",children:n.contactNum||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"font-medium",children:n.address})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Farm Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Type"}),e.jsx("p",{className:"font-medium",children:n.cropType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Area"}),e.jsxs("p",{className:"font-medium",children:[n.cropArea," hectares"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Lot Number"}),e.jsx("p",{className:"font-medium",children:n.lotNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Lot Area"}),e.jsx("p",{className:"font-medium",children:n.lotArea||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Certified"}),e.jsx("p",{className:"font-medium",children:n.isCertified?e.jsxs("span",{className:"text-green-600 flex items-center",children:[e.jsx(Te,{size:16,className:"mr-1"})," Yes"]}):e.jsx("span",{className:"text-gray-600",children:"No"})})]})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-3",children:"Insurance Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Insurance Type"}),e.jsx("p",{className:"font-medium",children:n.insuranceType||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Premium Amount"}),e.jsx("p",{className:"font-medium",children:n.premiumAmount||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Period From"}),e.jsx("p",{className:"font-medium",children:n.periodFrom||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Period To"}),e.jsx("p",{className:"font-medium",children:n.periodTo||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Agency"}),e.jsx("p",{className:"font-medium",children:n.agency||"Not provided"})]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>de(!1),className:"bg-lime-700 text-white px-6 py-2 rounded-lg hover:bg-lime-800 transition",children:"Close"})})]})]})}),h&&V&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 text-gray-800 flex items-center",children:[e.jsx(De,{className:"mr-2 text-red-500",size:24}),"Delete Farmer"]}),e.jsxs("p",{className:"mb-6 text-gray-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:V.farmerName}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{I(!1),F(null)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:()=>{W(T=>T.filter(me=>me.id!==V.id));const c=G.filter(T=>T.id!==V.id);localStorage.setItem("farmers",JSON.stringify(c)),I(!1),F(null),alert("Farmer deleted successfully!")},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center",children:[e.jsx(ee,{size:16,className:"mr-1"}),"Delete"]})]})]})})]})},Er=()=>{const{data:x=[],isLoading:Q}=bt(),{data:m=[],isLoading:C}=ft(),{data:ie={},isLoading:H}=fr(),A=br(),i=yr(),k=jr(),W=Q||C||H||A.isPending||i.isPending||k.isPending,[te,ce]=o.useState(""),[K,Z]=o.useState(!1),[se,d]=o.useState(!1),[f,b]=o.useState(!1),[u,y]=o.useState(null),[B,q]=o.useState({farmerId:"",cropType:"",cropArea:"",lotNumber:"",lotArea:"",plantingDate:"",expectedHarvestDate:"",insuranceDayLimit:"",notes:"",location:{lat:null,lng:null}}),l={Corn:{dayLimit:30,description:"Maize crop with 30-day insurance window"},Rice:{dayLimit:25,description:"Rice crop with 25-day insurance window"},Wheat:{dayLimit:20,description:"Wheat crop with 20-day insurance window"},Soybeans:{dayLimit:35,description:"Soybean crop with 35-day insurance window"},Cotton:{dayLimit:40,description:"Cotton crop with 40-day insurance window"},Sugarcane:{dayLimit:45,description:"Sugarcane crop with 45-day insurance window"},Coffee:{dayLimit:50,description:"Coffee crop with 50-day insurance window"},Cacao:{dayLimit:55,description:"Cacao crop with 55-day insurance window"},Other:{dayLimit:30,description:"Other crops with 30-day insurance window"}},P=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ae=p=>{const{name:j,value:S}=p.target;q(de=>({...de,[j]:S})),j==="cropType"&&l[S]&&q(de=>({...de,cropType:S,insuranceDayLimit:l[S].dayLimit.toString()}))},oe=async p=>{p.preventDefault();try{const j={...B,cropArea:parseFloat(B.cropArea),lotArea:parseFloat(B.lotArea),insuranceDayLimit:parseInt(B.insuranceDayLimit),plantingDate:new Date(B.plantingDate).toISOString(),expectedHarvestDate:new Date(B.expectedHarvestDate).toISOString()};await A.mutateAsync(j),Z(!1),q({farmerId:"",cropType:"",cropArea:"",lotNumber:"",lotArea:"",plantingDate:"",expectedHarvestDate:"",insuranceDayLimit:"",notes:"",location:{lat:null,lng:null}}),D.getState().addAdminNotification({id:P(),type:"success",title:"Crop Insurance Created",message:"New crop insurance record has been created successfully.",timestamp:new Date})}catch(j){D.getState().addAdminNotification({id:P(),type:"error",title:"Error Creating Record",message:j.message,timestamp:new Date})}},L=async(p,j)=>{try{await i.mutateAsync({id:p,updateData:{isInsured:!0,insuranceType:j.insuranceType,premiumAmount:parseFloat(j.premiumAmount),agency:j.agency,insuranceDate:new Date().toISOString()}}),D.getState().addAdminNotification({id:P(),type:"success",title:"Insurance Applied",message:"Crop insurance has been applied successfully.",timestamp:new Date})}catch(S){D.getState().addAdminNotification({id:P(),type:"error",title:"Error Applying Insurance",message:S.message,timestamp:new Date})}},Ce=async p=>{if(window.confirm("Are you sure you want to delete this crop insurance record?"))try{await k.mutateAsync(p),D.getState().addAdminNotification({id:P(),type:"success",title:"Record Deleted",message:"Crop insurance record has been deleted successfully.",timestamp:new Date})}catch(j){D.getState().addAdminNotification({id:P(),type:"error",title:"Error Deleting Record",message:j.message,timestamp:new Date})}},Ne=p=>{if(typeof p=="object"&&p!==null)return`${p.firstName} ${p.lastName}`;{const j=m.find(S=>S._id===p);return j?`${j.firstName} ${j.lastName}`:"Unknown Farmer"}},Y=p=>new Date(p).toLocaleDateString(),ve=p=>{const j=new Date,S=new Date(p.insuranceDeadline),de=Math.ceil((S-j)/(1e3*60*60*24));return Math.max(0,de)},ke=p=>p.isInsured?"text-green-600":p.canInsure?"text-yellow-600":"text-red-600",$e=p=>p.isInsured?"Insured":p.canInsure?"Can Insure":"Expired",qe=x.filter(p=>{const j=Ne(p.farmerId).toLowerCase(),S=p.cropType.toLowerCase(),de=te.toLowerCase();return j.includes(de)||S.includes(de)});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Crop Insurance Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage crop insurance records with day limits"})]}),e.jsxs("button",{onClick:()=>Z(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-green-700",children:[e.jsx(is,{size:20}),"Add New Crop"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Crops"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:ie.totalCrops||0})]}),e.jsx(ir,{className:"text-green-600",size:24})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Insured Crops"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:ie.insuredCrops||0})]}),e.jsx(Is,{className:"text-green-600",size:24})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Uninsured Crops"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:ie.uninsuredCrops||0})]}),e.jsx(De,{className:"text-yellow-600",size:24})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Insurance Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[ie.insuranceRate||0,"%"]})]}),e.jsx(gt,{className:"text-blue-600",size:24})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search by farmer name or crop type...",value:te,onChange:p=>ce(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})})})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Farmer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Crop Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Planting Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expected Harvest"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Day Limit"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:qe.map(p=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ne(p.farmerId)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:p.cropType}),e.jsxs("div",{className:"text-sm text-gray-500",children:[p.cropArea," ha • Lot ",p.lotNumber]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:Y(p.plantingDate)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:Y(p.expectedHarvestDate)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[p.insuranceDayLimit," days"]}),!p.isInsured&&p.canInsure&&e.jsxs("div",{className:"text-xs text-yellow-600",children:[ve(p)," days left"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ke(p)}`,children:[p.isInsured?e.jsx(Te,{className:"w-4 h-4 mr-1"}):p.canInsure?e.jsx(or,{className:"w-4 h-4 mr-1"}):e.jsx(ee,{className:"w-4 h-4 mr-1"}),$e(p)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{y(p),b(!0)},className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",children:[e.jsx(Wt,{size:16}),e.jsx("span",{children:"View"})]}),!p.isInsured&&p.canInsure&&e.jsxs("button",{onClick:()=>{y(p),d(!0)},className:"text-green-600 hover:text-green-900 flex items-center gap-1",children:[e.jsx(Is,{size:16}),e.jsx("span",{children:"Insure"})]}),e.jsxs("button",{onClick:()=>Ce(p._id),className:"text-red-600 hover:text-red-900 flex items-center gap-1",children:[e.jsx(dr,{size:16}),e.jsx("span",{children:"Delete"})]})]})})]},p._id))})]})})}),K&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Add New Crop Insurance Record"}),e.jsx("button",{onClick:()=>Z(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ee,{size:24})})]}),e.jsxs("form",{onSubmit:oe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Farmer"}),e.jsxs("select",{name:"farmerId",value:B.farmerId,onChange:ae,required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Select Farmer"}),m.map(p=>e.jsxs("option",{value:p._id,children:[p.firstName," ",p.lastName]},p._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Crop Type"}),e.jsxs("select",{name:"cropType",value:B.cropType,onChange:ae,required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Select Crop Type"}),Object.keys(l).map(p=>e.jsxs("option",{value:p,children:[p," (",l[p].dayLimit," days)"]},p))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Crop Area (hectares)"}),e.jsx("input",{type:"number",name:"cropArea",value:B.cropArea,onChange:ae,required:!0,step:"0.01",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lot Number"}),e.jsx("input",{type:"text",name:"lotNumber",value:B.lotNumber,onChange:ae,required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lot Area (hectares)"}),e.jsx("input",{type:"number",name:"lotArea",value:B.lotArea,onChange:ae,required:!0,step:"0.01",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Insurance Day Limit"}),e.jsx("input",{type:"number",name:"insuranceDayLimit",value:B.insuranceDayLimit,onChange:ae,required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Planting Date"}),e.jsx("input",{type:"date",name:"plantingDate",value:B.plantingDate,onChange:ae,required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Harvest Date"}),e.jsx("input",{type:"date",name:"expectedHarvestDate",value:B.expectedHarvestDate,onChange:ae,required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{name:"notes",value:B.notes,onChange:ae,rows:"3",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Z(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:W,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:W?"Creating...":"Create Record"})]})]})]})}),se&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Apply Insurance"}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Applying insurance for ",u.cropType," crop by ",Ne(u.farmerId)]}),e.jsxs("p",{className:"text-xs text-yellow-600",children:[ve(u)," days remaining to apply insurance"]})]}),e.jsxs("form",{onSubmit:p=>{p.preventDefault();const j=new FormData(p.target);L(u._id,{insuranceType:j.get("insuranceType"),premiumAmount:j.get("premiumAmount"),agency:j.get("agency")}),d(!1)},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Insurance Type"}),e.jsxs("select",{name:"insuranceType",required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Select Insurance Type"}),e.jsx("option",{value:"Basic",children:"Basic Coverage"}),e.jsx("option",{value:"Premium",children:"Premium Coverage"}),e.jsx("option",{value:"Comprehensive",children:"Comprehensive Coverage"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Premium Amount"}),e.jsx("input",{type:"number",name:"premiumAmount",required:!0,step:"0.01",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Insurance Agency"}),e.jsx("input",{type:"text",name:"agency",required:!0,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Apply Insurance"})]})]})]})}),f&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Crop Insurance Details"}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Farmer Information"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Name: ",Ne(u.farmerId)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Crop: ",u.cropType]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Area: ",u.cropArea," hectares"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Lot: ",u.lotNumber]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Timeline"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Planting: ",Y(u.plantingDate)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Expected Harvest: ",Y(u.expectedHarvestDate)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Insurance Deadline: ",Y(u.insuranceDeadline)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Day Limit: ",u.insuranceDayLimit," days"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Insurance Status"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",e.jsx("span",{className:ke(u),children:$e(u)})]}),u.isInsured&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Insurance Date: ",Y(u.insuranceDate)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Insurance Type: ",u.insuranceType]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Premium: ₱",u.premiumAmount]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Agency: ",u.agency]})]}),!u.isInsured&&u.canInsure&&e.jsxs("p",{className:"text-sm text-yellow-600",children:[ve(u)," days remaining to apply insurance"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Additional Information"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Created: ",Y(u.createdAt)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Updated: ",Y(u.updatedAt)]}),u.notes&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Notes: ",u.notes]})]})]})]})})]})};let bs=null;function qr(x="Loading..."){bs||(bs=ht.loading(x,{id:"global-loading"}))}function Yr(){bs&&(ht.dismiss(bs),bs=null)}function Or(x){let Q=x;ht.error(Q)}ys.register(...Ka);ys.register(mt,xt,ut,qt,Yt,pt,Ot,Fs,zs,Bt,Za);const Br=`
  /* Hide scrollbar but maintain functionality */
  .hide-scrollbar {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
  }
  .hide-scrollbar::-webkit-scrollbar {
    display: none;  /* Chrome, Safari and Opera */
  }
`,tn=()=>{var $t;const x=Wa(),Q=_a(s=>s.logout),[m,C]=o.useState(!1),[ie,H]=o.useState(!1),[A,i]=o.useState(!1),[k,W]=o.useState("home"),[te,ce]=o.useState(!1),[K,Z]=o.useState(!1),[se,d]=o.useState(null),{data:f=[],isLoading:b,refetch:u}=Nr(),{data:y=[],isLoading:B}=ft(),{data:q=[],isLoading:l}=bt(),{data:P=[],isLoading:ae,error:oe}=vr(),{data:L=[],isLoading:Ce}=wr(),Ne=Cr(),Y=kr(),ve=Ar(),ke=Sr(),$e=Ht(),qe=Gt(),p=async s=>{try{return await ve.mutateAsync(s)}catch(t){throw t}},j=async(s,t)=>await Y.mutateAsync({applicationId:s,statusData:t}),S=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,de=()=>{Q(),x("/")},[n,h]=o.useState(""),[I,V]=o.useState(""),[F,G]=o.useState(1),re=10,X=o.useMemo(()=>P.filter(s=>(s.availableQuantity||0)<5),[P]),c=o.useMemo(()=>{let s=L||[];if(n&&(s=s.filter(t=>t.status===n)),I){const t=I.toLowerCase();s=s.filter(r=>{var U,O,J;const g=((U=r._id)==null?void 0:U.toLowerCase())||"",w=r.farmerId?`${r.farmerId.firstName} ${r.farmerId.lastName}`.toLowerCase():"",_=((J=(O=r.assistanceId)==null?void 0:O.assistanceType)==null?void 0:J.toLowerCase())||"";return g.includes(t)||w.includes(t)||_.includes(t)})}return s.sort((t,r)=>new Date(r.applicationDate)-new Date(t.applicationDate))},[L,n,I]),T=Math.ceil(c.length/re),me=o.useMemo(()=>{const s=(F-1)*re;return c.slice(s,s+re)},[c,F,re]);o.useEffect(()=>{},[P]);const ue=s=>{d(s),Z(!0)},[Ke,os]=o.useState(!1),[Ae,Ye]=o.useState(!1),Qe=o.useRef(null),a=o.useRef(null),N=o.useRef(null),$=o.useRef(null),z=o.useRef(null),R=o.useRef(null),[pe,ds]=o.useState(!1),[cs,Ze]=o.useState(!1),[M,ne]=o.useState({type:"",claimId:""}),[Oe,Ie]=o.useState(!1),[fe,es]=o.useState({type:"",applicationId:""}),[Me,Be]=o.useState(""),[Ee,Se]=o.useState(!1),[yt,jt]=o.useState(null),{adminNotifications:Rs,unreadAdminCount:Ps,markAdminNotificationsAsRead:Kt}=D(),[Zt,Xt]=o.useState(!1),[ea,ms]=o.useState(!1),[sa,Nt]=o.useState(!1),[Ms,Es]=o.useState("pending"),[vt,ta]=o.useState(new Date().getFullYear()),[xs,qs]=o.useState(""),[_e,us]=o.useState(null),[Ue,ss]=o.useState("view"),[ts,aa]=o.useState([7.6167,125.7]),[Ys,ra]=o.useState(7),[js,na]=o.useState("all"),[Ns,la]=o.useState("all"),[vs,ia]=o.useState("all"),as=o.useMemo(()=>{const s={};return q.forEach(t=>{const r=t.farmerId&&(t.farmerId._id||t.farmerId)||t.farmer||t.farmerID;if(!r)return;const g=String(r);s[g]||(s[g]=[]),s[g].push(t)}),s},[q]),[v,oa]=o.useState(null),[da,wt]=o.useState(!1),[ca]=o.useState(new Date),[Ct,Os]=o.useState(!1),kt={firstName:"",middleName:"",lastName:"",birthday:"",gender:"",contactNum:"",address:"",cropType:"",cropArea:"",farmName:"",insuranceType:"",premiumAmount:"",lotNumber:"",lotArea:"",agency:"",isCertified:!1,periodFrom:"",periodTo:"",location:null},[we,ws]=o.useState({assistanceType:"",description:"",cropType:"",otherCropType:"",founderName:"",quantity:"",dateAdded:"",photo:""}),[,At]=o.useState(null),[ma,xa]=o.useState(kt),[xe,Bs]=o.useState(!1),[He,_s]=o.useState(!1),[ua,Us]=o.useState(null),[ps,Cs]=o.useState({firstName:"",middleName:"",lastName:"",birthday:"",gender:"",contactNum:"",address:"",cropType:"",cropArea:"",insuranceType:"",lotNumber:"",lotArea:"",agency:"",isCertified:!1,periodFrom:"",periodTo:"",username:"",password:""}),pa=s=>{const{name:t,type:r,value:g,checked:w}=s.target;Cs(_=>({..._,[t]:r==="checkbox"?w:g}))},ga=async s=>{s.preventDefault();try{const t={...ps,location:_e};await $e.mutateAsync(t),Cs({firstName:"",middleName:"",lastName:"",birthday:"",gender:"",contactNum:"",address:"",cropType:"",cropArea:"",insuranceType:"",lotNumber:"",lotArea:"",agency:"",isCertified:!1,periodFrom:"",periodTo:"",username:"",password:""}),us(null),Nt(!1),D.getState().addAdminNotification({id:S(),type:"success",title:"Farmer Registered Successfully",message:`${ps.firstName} ${ps.lastName} has been registered successfully.`,timestamp:new Date})}catch(t){D.getState().addAdminNotification({id:S(),type:"error",title:"Registration Failed",message:`Error: ${t.message}`,timestamp:new Date})}},Ws=()=>{!N.current||!a.current||(N.current.clearLayers(),y.forEach(s=>{if(s.location){const r=(O=>O.farmerName?O.farmerName:O.name?O.name:O.firstName||O.lastName?`${O.firstName||""} ${O.middleName||""} ${O.lastName||""}`.replace(/  +/g," ").trim():"Unknown Farmer")(s),g=s.cropType||"Not specified",w=s.lotArea||s.cropArea||"Not specified",_=s.isCertified?"✓ Certified":"";Fe.marker([s.location.lat,s.location.lng]).bindPopup(`
          <strong>${r}</strong><br>
          Crop: ${g}<br>
          Area: ${w}<br>
          ${_}
        `).addTo(N.current)}}))},ks=(s,t)=>{fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${t}`).then(r=>r.json()).then(r=>{if(r&&r.display_name){const g=`LOT-${Math.abs(s).toFixed(4)}-${Math.abs(t).toFixed(4)}`.replace(/\./g,"");Cs(w=>({...w,address:r.display_name,lotNumber:g}))}}).catch(r=>{})},ha=s=>{if(!s)return"📍";const t=String(s).toLowerCase().trim();return t.includes("rice")||t.includes("palay")?"🌾":t.includes("corn")||t.includes("maize")?"🌽":t.includes("banana")?"🍌":t.includes("coconut")?"🥥":t.includes("coffee")?"☕":t.includes("cacao")||t.includes("cocoa")?"🍫":t.includes("sugar")||t.includes("sugarcane")?"🌿":t.includes("pineapple")?"🍍":t.includes("mango")?"🥭":t.includes("rubber")?"🟢":t.includes("vegetable")||t.includes("veg")?"🥬":t.includes("fruit")?"🍎":t.includes("tobacco")?"🍂":"📍"},St=o.useCallback(()=>{if(!R.current||!z.current)return;R.current.clearLayers();const s={},t={};if(y.forEach(r=>{var g,w;if(r.location&&typeof r.location.lat=="number"&&typeof r.location.lng=="number"){const U=(E=>E.farmerName?E.farmerName:E.name?E.name:E.firstName||E.lastName?`${E.firstName||""} ${E.middleName||""} ${E.lastName||""}`.replace(/  +/g," ").trim():"Unknown Farmer")(r),O=String(r._id||r.id||""),J=(as[O]||[]).map(E=>E.cropType).filter(Boolean),ge=Array.from(new Set(J)),le=ge.length>0?ge.join(", "):r.cropType||"Not specified",he=r.address?((g=r.address.split(",").find(E=>E.includes("Barangay")||E.includes("Brgy")))==null?void 0:g.trim())||((w=r.address.split(",")[0])==null?void 0:w.trim())||"Unknown Barangay":`Area ${Math.floor(r.location.lat*100)%100}`,ye=[];r.registrationDate&&ye.push(new Date(r.registrationDate)),r.createdAt&&ye.push(new Date(r.createdAt)),(as[O]||[]).length>0&&(as[O]||[]).forEach(E=>{E!=null&&E.plantingDate&&ye.push(new Date(E.plantingDate)),E!=null&&E.createdAt&&ye.push(new Date(E.createdAt))});const je=ye.find(E=>!isNaN(E))||null;if(js!=="all"&&!(ge.length>0?ge:[r.cropType]).some(zt=>zt&&zt.toLowerCase()===String(js).toLowerCase())||vs!=="all"&&je&&je.getFullYear()!==Number(vs)||Ns!=="all"&&je&&je.getMonth()+1!==Number(Ns))return;const Ss=ge.length>0,Ds=f.some(E=>{var Xs;return E.farmerId===O||((Xs=E.name)==null?void 0:Xs.toLowerCase().includes(U.toLowerCase()))}),It=L.filter(E=>E.farmerId===O&&(E.status==="approved"||E.status==="distributed")).length,Lt=r.lotArea||r.cropArea||"Not specified",Ft=r.isCertified?"✓ Certified":"❌ Not Certified";s[he]||(s[he]=[]),s[he].push({farmer:r,farmerName:U,cropType:le,lotArea:Lt,isCertified:Ft,isInsured:Ss,hasActiveClaim:Ds,assistanceReceived:It});const Zs=`${Math.floor(r.location.lat*1e3)},${Math.floor(r.location.lng*1e3)}`;t[Zs]||(t[Zs]={lat:r.location.lat,lng:r.location.lng,count:0}),Ds&&t[Zs].count++;let ns;Ds?ns="#f97316":Ss?ns="#22c55e":ns="#ef4444";const Ea=(ge[0]||r.cropType||"").split(",")[0].trim(),qa=ha(Ea),Ya=`<div style="
          width:32px;
          height:32px;
          border-radius:50%;
          display:flex;
          align-items:center;
          justify-content:center;
          border:3px solid ${ns};
          background:#ffffff;
          color:#111827;
          font-size:14px;
          font-weight:bold;
          box-shadow: 0 2px 8px rgba(0,0,0,0.3);
          cursor:pointer;
        ">${qa}</div>`,Oa=Fe.divIcon({className:"enhanced-crop-marker",html:Ya,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),Ba=`
          <div style="min-width:250px; font-family: system-ui, -apple-system, sans-serif;">
            <div style="background: linear-gradient(135deg, ${ns} 0%, ${ns}99 100%); color: white; padding: 8px; margin: -9px -9px 8px -9px; border-radius: 4px 4px 0 0;">
              <h4 style="margin: 0; font-size: 16px; font-weight: bold;">👨‍🌾 ${U}</h4>
              <small style="opacity: 0.9;">📍 ${he}</small>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
              <div>
                <strong style="color: #374151; font-size: 12px;">🌾 CROP:</strong><br>
                <span style="color: #059669; font-weight: 500;">${le}</span>
              </div>
              <div>
                <strong style="color: #374151; font-size: 12px;">📏 AREA:</strong><br>
                <span style="color: #0891b2;">${Lt}</span>
              </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
              <div>
                <strong style="color: #374151; font-size: 12px;">🛡️ INSURANCE:</strong><br>
                <span style="color: ${Ss?"#059669":"#dc2626"}; font-weight: 500;">
                  ${Ss?"✅ Insured":"❌ Uninsured"}
                </span>
              </div>
              <div>
                <strong style="color: #374151; font-size: 12px;">🎯 STATUS:</strong><br>
                <span style="color: #7c3aed;">${Ft}</span>
              </div>
            </div>
            
            <div style="background: #f3f4f6; padding: 6px; border-radius: 4px; margin-top: 8px;">
              <div style="display: flex; justify-content: space-between; font-size: 12px;">
                <span><strong>🤝 Assistance Received:</strong></span>
                <span style="color: #059669; font-weight: bold;">${It}</span>
              </div>
              ${Ds?'<div style="color: #f97316; font-size: 11px; margin-top: 4px;"><strong>⚠️ Has Active Claims</strong></div>':""}
            </div>
          </div>
        `;Fe.marker([r.location.lat,r.location.lng],{icon:Oa}).bindPopup(Ba,{maxWidth:300,className:"enhanced-popup"}).addTo(R.current)}}),!document.getElementById("enhanced-popup-styles")){const r=document.createElement("style");r.id="enhanced-popup-styles",r.textContent=`
        .enhanced-popup .leaflet-popup-content-wrapper {
          border-radius: 8px;
          box-shadow: 0 8px 32px rgba(0,0,0,0.15);
        }
        .enhanced-popup .leaflet-popup-content {
          margin: 0;
          line-height: 1.4;
        }
        .enhanced-crop-marker {
          transition: transform 0.2s ease;
        }
        .enhanced-crop-marker:hover {
          transform: scale(1.1);
        }
      `,document.head.appendChild(r)}},[y,as,js,Ns,vs,f,L]),Qs=o.useCallback(async()=>{try{qr("Loading claims..."),Os(!0),await u()}catch{Or("Failed to load claims from the server.")}finally{Yr(),Os(!1)}},[u]);o.useEffect(()=>{const s=setInterval(Qs,5e3);return()=>clearInterval(s)},[Qs]);const fa=y.length,ba=f.filter(s=>s.status==="pending").length,ya=f.filter(s=>s.status==="approved").length,ja=s=>{const{name:t,value:r,type:g,files:w}=s.target;if(g==="file"&&w&&w[0]){const _=new FileReader;_.onload=U=>{ws(O=>({...O,photo:U.target.result}))},_.readAsDataURL(w[0])}else ws(_=>({..._,[t]:r}))},Na=async s=>{if(s.preventDefault(),!we.assistanceType||!we.description||!we.cropType||!we.founderName||!we.quantity||!we.dateAdded||we.cropType==="Other"&&!we.otherCropType){D.getState().addAdminNotification({id:S(),type:"error",title:"Validation Error",message:"Please fill in all required fields.",timestamp:new Date});return}try{const t={...we,cropType:we.cropType==="Other"?we.otherCropType:we.cropType,availableQuantity:parseInt(we.quantity),requiresRSBSA:!0,requiresCertification:!1,maxQuantityPerFarmer:100,quarterlyLimit:!0,status:"active"};await p(t),ws({assistanceType:"",description:"",cropType:"",otherCropType:"",founderName:"",quantity:"",dateAdded:"",photo:""}),At(null),ms(!1),D.getState().addAdminNotification({id:S(),type:"success",title:"Assistance Added Successfully",message:`${t.assistanceType} has been added to the assistance inventory.`,timestamp:new Date});const r=y.filter(g=>g.cropType&&g.cropType.toLowerCase()===t.cropType.toLowerCase());r.forEach(g=>{D.getState().addFarmerNotification({id:`new-assistance-${S()}-${g._id}`,type:"info",title:"New Assistance Available",message:`New ${t.assistanceType} assistance is now available for ${t.cropType} farmers!`,timestamp:new Date},g._id)}),r.length>0&&D.getState().addAdminNotification({id:S(),type:"info",title:"Farmers Notified",message:`${r.length} farmer(s) with ${t.cropType} crop type have been notified about the new assistance.`,timestamp:new Date})}catch(t){D.getState().addAdminNotification({id:S(),type:"error",title:"Add Assistance Failed",message:`Error: ${t.message}`,timestamp:new Date})}},va=s=>{var r;const t=P[s];ws({assistanceType:t.assistanceType||"",description:t.description||"",cropType:t.cropType||"",otherCropType:t.otherCropType||"",founderName:t.founderName||"",quantity:((r=t.availableQuantity)==null?void 0:r.toString())||"",dateAdded:t.dateAdded||"",photo:t.photo||""}),At(s),ms(!0)},wa=s=>{const t=P[s];es({type:"delete",applicationId:t._id,itemName:t.assistanceType}),Ie(!0)},Ca=s=>{es({type:"approved",applicationId:s}),Be(""),Ie(!0)},ka=s=>{es({type:"rejected",applicationId:s}),Be(""),Ie(!0)},Aa=async s=>{try{await j(s,{status:"distributed"}),D.getState().addAdminNotification({id:S(),type:"success",title:"Application Distributed",message:"Application has been marked as distributed successfully.",timestamp:new Date})}catch(t){D.getState().addAdminNotification({id:S(),type:"error",title:"Distribution Failed",message:`Error: ${t.message}`,timestamp:new Date})}},Sa=async()=>{const{type:s,applicationId:t,itemName:r}=fe;try{if(s==="delete")await ke.mutateAsync(t),D.getState().addAdminNotification({id:S(),type:"success",title:"Assistance Deleted",message:`${r} has been deleted successfully.`,timestamp:new Date}),Ie(!1),Be("");else{await j(t,{status:s,officerNotes:Me}),D.getState().addAdminNotification({id:S(),type:"success",title:`Application ${s.charAt(0).toUpperCase()+s.slice(1)}`,message:`Application has been ${s} successfully.`,timestamp:new Date});const g=L.find(w=>w._id===t);if(g&&g.farmerId){const w=s==="approved"?`Your assistance application has been approved! ${Me?`Feedback: ${Me}`:""}`:s==="rejected"?`Your assistance application has been rejected. ${Me?`Reason: ${Me}`:""}`:`Your assistance has been distributed successfully! ${Me?`Notes: ${Me}`:""}`;D.getState().addFarmerNotification({id:`application-${s}-${t}`,type:s==="approved"?"success":s==="rejected"?"error":"info",title:`Application ${s.charAt(0).toUpperCase()+s.slice(1)}`,message:w,timestamp:new Date},g.farmerId)}Ie(!1),Be("")}}catch(g){D.getState().addAdminNotification({id:S(),type:"error",title:"Action Failed",message:`Error: ${g.message}`,timestamp:new Date})}},[Le,Xe]=o.useState(""),Dt=(s,t,r)=>{ne({type:t,claimId:s,farmerId:r}),Xe(""),Ze(!0)},Hs=async()=>{const{type:s,claimId:t,farmerId:r}=M;try{await Ne.mutateAsync({id:t,updateData:{status:s,adminFeedback:Le}}),Ze(!1),Xe("");const g=f.find(_=>_._id===t||_.id===t);let w=`Claim has been ${s} successfully.`;if(s==="approved"&&g&&g.compensation&&(w=`Claim approved! Compensation: ₱${g.compensation.toLocaleString()}. Total Insurance Paid updated.`),D.getState().addAdminNotification({id:S(),type:"success",title:`Claim ${s.charAt(0).toUpperCase()+s.slice(1)}`,message:w,timestamp:new Date}),g&&(g.farmerId||r)){const _=g.farmerId||r,U=s==="approved"?"success":"error",O=s==="approved"?"Claim Approved!":"Claim Rejected";let J;if(s==="approved"){const ge=g.compensation?`₱${g.compensation.toLocaleString()}`:"calculated amount";J=`Your claim for ${g.crop} damage has been approved! Compensation: ${ge}. ${Le?`Feedback: ${Le}`:""}`}else J=`Your claim for ${g.crop} damage has been rejected. ${Le?`Reason: ${Le}`:""}`;D.getState().addFarmerNotification({id:`claim-${s}-${t}-${S()}`,type:U,title:O,message:J,timestamp:new Date},_)}}catch(g){D.getState().addAdminNotification({id:S(),type:"error",title:"Claim Update Failed",message:`Failed to update claim status: ${g.message}`,timestamp:new Date})}},Da=s=>{jt(s),Se(!0),D.getState().addAdminNotification({id:`view-claim-${s._id||s.id}`,type:"info",title:"Viewing Claim Details",message:`Reviewing claim from ${s.name} for ${s.crop} damage.`,timestamp:new Date})},Ta=s=>{const r=Math.floor((new Date().getTime()-s.getTime())/(1e3*60*60));return r<1?"Just now":r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`},$a=s=>{switch(s){case"success":return e.jsx(Ut,{className:"h-5 w-5 text-green-500"});case"warning":return e.jsx(De,{className:"h-5 w-5 text-yellow-500"});case"error":return e.jsx(ee,{className:"h-5 w-5 text-red-500"});case"info":default:return e.jsx(Qt,{className:"h-5 w-5 text-blue-500"})}},Ia=()=>{ce(!te),te||Kt()};o.useEffect(()=>{const s=t=>{te&&!t.target.closest(".notification-panel")&&ce(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[te]);const La=()=>{wt(!0),setTimeout(()=>{const s=f,t={January:{approved:0,rejected:0,pending:0,completed:0},February:{approved:0,rejected:0,pending:0,completed:0},March:{approved:0,rejected:0,pending:0,completed:0},April:{approved:0,rejected:0,pending:0,completed:0},May:{approved:0,rejected:0,pending:0,completed:0},June:{approved:0,rejected:0,pending:0,completed:0},July:{approved:0,rejected:0,pending:0,completed:0},August:{approved:0,rejected:0,pending:0,completed:0},September:{approved:0,rejected:0,pending:0,completed:0},October:{approved:0,rejected:0,pending:0,completed:0},November:{approved:0,rejected:0,pending:0,completed:0},December:{approved:0,rejected:0,pending:0,completed:0}},r={approved:0,rejected:0,pending:0,completed:0};s.forEach(le=>{const he=new Date(le.date).getMonth(),ye=new Date(0,he).toLocaleString("default",{month:"long"}),je=le.status||"pending";r[je]++,t[ye]&&(t[ye][je]||(t[ye][je]=0),t[ye][je]++,je==="approved"&&(t[ye].completed++,r.completed++))});const g=s.length||5,w=.15,_=Math.round(g*(1+w)),U={},O={};Object.keys(t).forEach(le=>{U[le]=0,O[le]={},Object.keys(t[le]).forEach(he=>{const ye=t[le][he]||0,je=Math.round(ye*(1+w));O[le][he]=je,(he==="approved"||he==="rejected")&&(U[le]+=je)})});const J={};Object.keys(r).forEach(le=>{J[le]=Math.round((r[le]||1)*(1+w))});const ge=[{status:"Approved",value:r.approved/g*100},{status:"Rejected",value:r.rejected/g*100},{status:"Pending",value:r.pending/g*100},{status:"Completed",value:r.completed/g*100}].sort((le,he)=>he.value-le.value);ge.length===0&&ge.push({status:"Approved",value:65},{status:"Rejected",value:25},{status:"Pending",value:10},{status:"Completed",value:60}),oa({currentYear:{totalClaims:g,byMonth:Object.keys(t).reduce((le,he)=>(le[he]=Object.values(t[he]).reduce((ye,je)=>ye+je,0),le),{}),byStatus:r,monthlyStatus:t},nextYear:{totalClaims:_,byMonth:U,byStatus:J,monthlyStatus:O},statusEfficiency:ge}),wt(!1),os(!0)},1500)},Fa=async()=>{try{const s=await Rt(()=>import("./chunk-OzYVDPTe.js").then(J=>J.j),__vite__mapDeps([0,1])),t=(await Rt(async()=>{const{default:J}=await import("./chunk-OzYVDPTe.js").then(ge=>ge.c);return{default:J}},__vite__mapDeps([0,1]))).default,r=new s.jsPDF;r.setFontSize(18),r.text("Agri-Insurance Analytics Report",14,22),r.setFontSize(12),r.text(`Generated on: ${new Date().toLocaleDateString()}`,14,30),r.setFontSize(14),r.text("Summary",14,40),r.setFontSize(10),r.text(`Total Claims: ${v.currentYear.totalClaims}`,14,50),r.text(`Predicted Claims Next Year: ${v.nextYear.totalClaims}`,14,55),r.text(`Growth Rate: ${Math.round((v.nextYear.totalClaims-v.currentYear.totalClaims)/v.currentYear.totalClaims*100)}%`,14,60),r.setFontSize(14),r.text("Status Distribution",14,75);const g=[["Approved",v.currentYear.byStatus.approved||0,v.nextYear.byStatus.approved||0],["Rejected",v.currentYear.byStatus.rejected||0,v.nextYear.byStatus.rejected||0],["Pending",v.currentYear.byStatus.pending||0,v.nextYear.byStatus.pending||0],["Completed",v.currentYear.byStatus.completed||0,v.nextYear.byStatus.completed||0]];t(r,{startY:80,head:[["Status","Current Claims","Predicted Claims"]],body:g});const w=r.lastAutoTable.finalY+15;r.setFontSize(14),r.text("Status Assessment",14,w);const _=v.statusEfficiency.map(J=>[J.status,`${Math.round(J.value)}%`,J.value>50?"High":J.value>30?"Medium":"Low"]);t(r,{startY:w+5,head:[["Status Type","Percentage","Efficiency Level"]],body:_});const U=r.lastAutoTable.finalY+15;r.setFontSize(14),r.text("Recommendations",14,U),r.setFontSize(10);const O=Object.entries(v.nextYear.byMonth).sort((J,ge)=>ge[1]-J[1]).slice(0,2).map(([J])=>J).join(" and ");r.text(`1. Focus on improving processing efficiency for ${O} months.`,14,U+10),r.text("2. Prepare for increased claim processing during peak months.",14,U+15),r.text("3. Consider adjusting approval criteria based on the status assessment data.",14,U+20),r.save("agri-insurance-analytics-report.pdf")}catch{alert("PDF generation is not available. Please check console for errors.")}},[Ge,Gs]=o.useState(1),[Vs]=o.useState(3),rs=Math.ceil(P.length/Vs),Js=P.slice((Ge-1)*Vs,Ge*Vs);o.useEffect(()=>{},[Js,Ge,rs]),o.useEffect(()=>(Ae&&Qe.current&&(a.current?(a.current.setView(ts,Ys),setTimeout(()=>{a.current&&a.current.invalidateSize()},100)):(a.current=Fe.map(Qe.current).setView(ts,12),Fe.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(a.current),N.current=Fe.layerGroup().addTo(a.current),a.current.on("click",s=>{Ue==="add"&&(us({lat:s.latlng.lat,lng:s.latlng.lng}),N.current&&N.current.clearLayers(),Fe.marker([s.latlng.lat,s.latlng.lng]).addTo(N.current),ks(s.latlng.lat,s.latlng.lng))})),Ws()),()=>{a.current&&!Ae&&(a.current.remove(),a.current=null)}),[Ae,ts,Ys,Ue,y,ks,Ws]),o.useEffect(()=>{if(k!=="home"){z.current&&(z.current.remove(),z.current=null,R.current=null);return}$.current&&(z.current||(z.current=Fe.map($.current).setView(ts,10),Fe.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(z.current),R.current=Fe.layerGroup().addTo(z.current)),setTimeout(()=>{z.current&&z.current.invalidateSize()},100),St())},[k,y,ts,St]);const As=()=>{xs.trim()&&fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(xs)}`).then(s=>s.json()).then(s=>{if(s&&s.length>0){const{lat:t,lon:r}=s[0];a.current&&(a.current.setView([t,r],13),Ue==="add"&&(us({lat:t,lng:r}),N.current.clearLayers(),Fe.marker([t,r]).addTo(N.current),ks(t,r)))}else alert("Location not found. Please try a different search term.")}).catch(s=>{alert("Error searching for location. Please try again.")})},[za,Ks]=o.useState(!1),[be,Tt]=o.useState(null);o.useEffect(()=>{X.length>0&&D.getState().addAdminNotification({id:S(),type:"warning",title:"Low Stock Alert",message:`The following assistance items are low in stock: ${X.map(s=>s.assistanceType).join(", ")}. Please restock soon.`,timestamp:new Date})},[P,X]);const[Ra,Pa]=o.useState(""),Ma=o.useMemo(()=>{const s=new Set;return Object.values(as||{}).forEach(t=>{t.forEach(r=>{r&&r.cropType&&s.add(r.cropType)})}),y.forEach(t=>{t&&t.cropType&&s.add(t.cropType)}),Array.from(s).sort()},[y,as]);return o.useEffect(()=>{if(!document.getElementById("lato-font")){const t=document.createElement("link");t.id="lato-font",t.rel="stylesheet",t.href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap",document.head.appendChild(t)}},[]),e.jsxs("div",{className:"admin-lato min-h-screen bg-gradient-to-b from-lime-50 to-white relative flex flex-col",style:{fontFamily:"'Lato', sans-serif"},children:[e.jsx("style",{children:Br}),e.jsx("style",{children:".admin-lato, .admin-lato * { font-family: 'Lato', sans-serif !important; }"}),e.jsx("header",{style:{backgroundColor:"rgb(39, 78, 19)"},className:"text-black",children:e.jsxs("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>H(!ie),className:"mr-4 md:hidden","aria-label":"Toggle menu",children:ie?e.jsx(ee,{size:24}):e.jsx(cr,{size:24})}),e.jsx("img",{src:Ha,alt:"Admin Logo",className:"h-15 w-auto mr-3"}),e.jsx("h1",{className:"text-xl font-sans font-semibold tracking-wide text-white",children:"ADMIN DASHBOARD"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-white text-sm",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${Ct?"bg-yellow-400 animate-pulse":"bg-green-400"}`}),e.jsx("span",{className:"hidden sm:inline",children:Ct?"Refreshing...":"Live"}),e.jsxs("span",{className:"text-xs opacity-75",children:["Last: ",ca.toLocaleTimeString()]}),e.jsx("button",{onClick:()=>{Os(!0),Qs()},className:"ml-2 px-2 py-1 bg-white bg-opacity-20 rounded text-xs hover:bg-opacity-30 transition-colors",title:"Manual refresh",children:"↻"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:Ia,className:`text-white p-2 rounded-full hover:bg-lime-500 transition-colors relative ${Ps>0?"animate-pulse":""}`,style:{backgroundColor:"rgb(56, 118, 29)"},"aria-label":"Notifications",children:[e.jsx(mr,{size:22}),Ps>0&&e.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full animate-pulse",children:Ps})]}),te&&e.jsxs("div",{className:"notification-panel absolute right-0 mt-2 w-80 sm:w-96 bg-white rounded-lg shadow-xl z-50 overflow-hidden",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-4 text-white flex justify-between items-center",style:{backgroundColor:"rgb(56, 118, 29)"},children:[e.jsx("h3",{className:"font-semibold",children:"Notifications"}),Rs.length>0&&e.jsx("button",{onClick:()=>D.getState().clearNotifications(),className:"text-white hover:text-gray-200 text-sm",title:"Clear all notifications",children:"Clear All"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto hide-scrollbar",children:Rs.length===0?e.jsxs("div",{className:"p-4 text-center text-gray-500",children:[e.jsx(xr,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No notifications"})]}):Rs.map(s=>e.jsx("div",{className:"p-4 border-b border-gray-100 hover:bg-gray-50",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:$a(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:Ta(new Date(s.timestamp))}),e.jsx("button",{onClick:()=>D.getState().removeAdminNotification(s.id),className:"text-gray-400 hover:text-red-500 transition-colors","aria-label":"Remove notification",children:e.jsx(ee,{size:14})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.message})]})]})},s.id))})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>C(!m),className:"flex items-center space-x-2 focus:outline-none transition-colors","aria-label":"User menu",children:[e.jsx("div",{className:"w-8 h-8 bg-white text-lime-800 rounded-full flex items-center justify-center shadow-sm",children:e.jsx(Re,{size:18})}),e.jsx(nt,{size:16,className:`transition-transform ${m?"rotate-180":""}`})]}),m&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-20",children:[e.jsxs("button",{onClick:()=>{W("settings"),C(!1)},className:"flex items-center w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100",children:[e.jsx(it,{size:16,className:"mr-2"}),"Settings"]}),e.jsxs("button",{onClick:()=>{D.getState().addAdminNotification({id:S(),type:"info",title:"Help Center",message:"Help Center coming soon!",timestamp:new Date})},className:"flex items-center w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100",children:[e.jsx(ur,{size:16,className:"mr-2"}),"Help Center"]}),e.jsxs("button",{onClick:()=>{D.getState().addAdminNotification({id:S(),type:"success",title:"Test Notification",message:"This is a test notification to verify the delete functionality.",timestamp:new Date})},className:"flex items-center w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100",children:[e.jsx(is,{size:16,className:"mr-2"}),"Test Notification"]}),e.jsxs("button",{onClick:de,className:"flex items-center w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100",children:[e.jsx(pr,{size:16,className:"mr-2"}),"Logout"]})]})]})]})]})}),e.jsxs("div",{className:"flex flex-1",children:[e.jsxs("div",{id:"mobile-sidebar",className:`fixed inset-y-0 left-0 transform ${ie?"translate-x-0":"-translate-x-full"} md:hidden transition duration-200 ease-in-out z-30 w-64 bg-white shadow-lg`,children:[e.jsx("div",{className:"p-4 bg-lime-800 text-white",children:e.jsx("h2",{className:"text-xl font-bold",children:"Menu"})}),e.jsx("nav",{className:"p-4",children:e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>{W("home"),H(!1)},className:`flex items-center w-full p-2 rounded-lg ${k==="home"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-100"}`,style:k==="home"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,children:[e.jsx(Et,{size:24,className:"mr-3"}),"Dashboard"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{W("farmer-registration"),H(!1)},className:`flex items-center w-full p-2 rounded-lg ${k==="farmer-registration"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-100"}`,style:k==="farmer-registration"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,children:[e.jsx(Ve,{size:24,className:"mr-3"}),"Farmer Registration"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{Ye(!0),ss("view"),H(!1)},className:`flex items-center w-full p-2 rounded-lg hover:bg-gray-100 pl-10 ${Ae?"text-lime-800 font-bold":"text-gray-700"}`,style:Ae?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,children:[e.jsx(et,{size:24,className:"mr-3"}),"View Farm Locations"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{W("claims"),H(!1)},className:`flex items-center w-full p-2 rounded-lg ${k==="claims"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-100"}`,style:k==="claims"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,children:[e.jsx(Pe,{size:24,className:"mr-3"}),"Cash Assistance Claims"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{W("distribution"),H(!1)},className:`flex items-center w-full p-2 rounded-lg ${k==="distribution"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-100"}`,style:k==="distribution"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,children:[e.jsx($s,{size:24,className:"mr-3"}),"Distribution Records"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{W("assistance"),H(!1)},className:`flex items-center w-full p-2 rounded-lg ${k==="assistance"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-100"}`,style:k==="assistance"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,children:[e.jsx(Ts,{size:24,className:"mr-3"}),"Assistance Inventory"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{W("crop-insurance"),H(!1)},className:`flex items-center w-full p-2 rounded-lg ${k==="crop-insurance"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-100"}`,style:k==="crop-insurance"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,children:[e.jsx(Is,{size:24,className:"mr-3"}),"Crop Insurance"]})})]})})]}),e.jsxs("aside",{className:`hidden md:block ${A?"w-64":"w-16"} shadow-lg text-black space-y-6 border-r border-gray-100 sticky top-0 h-screen overflow-y-auto bg-white transition-all duration-300 ease-in-out group`,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[e.jsx("br",{}),e.jsxs("div",{className:"space-y-1 px-3",children:[e.jsxs("button",{onClick:()=>W("home"),className:`flex items-center ${A?"gap-3 px-4":"justify-center px-2"} py-2.5 rounded-lg w-full text-left transition-colors ${k==="home"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-50"}`,style:k==="home"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,title:A?"":"Dashboard",children:[e.jsx(Et,{size:24,className:"flex-shrink-0"}),A&&e.jsx("span",{children:"Dashboard"})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>{W("farmer-registration"),ds(!pe)},className:`flex items-center ${A?"justify-between gap-3 px-4":"justify-center px-2"} py-2.5 rounded-lg w-full text-left transition-colors ${k==="farmer-registration"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-50"}`,style:k==="farmer-registration"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,title:A?"":"Farmer Registration",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{size:24,className:"flex-shrink-0"}),A&&e.jsx("span",{children:"Farmer Registration"})]}),A&&e.jsx(nt,{size:16,className:`transition-transform ${pe?"rotate-180":""}`})]}),e.jsxs("div",{className:`transition-all duration-300 overflow-hidden ${pe&&A?"max-h-40":"max-h-0"}`,children:[e.jsxs("button",{onClick:()=>{Ye(!0),ss("view")},className:`flex items-center ${A?"gap-3 pl-10":"justify-center px-2"} py-2 rounded-lg hover:bg-gray-50 w-full text-left transition-colors ${Ae?"text-lime-800 font-bold":"text-gray-600"}`,style:Ae?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,title:A?"":"View Farm Locations",children:[e.jsx(et,{size:24,className:"flex-shrink-0"}),A&&e.jsx("span",{children:"View Farm Locations"})]}),e.jsxs("button",{onClick:()=>W("crop-insurance"),className:`flex items-center ${A?"gap-3 pl-10":"justify-center px-2"} py-2 rounded-lg hover:bg-gray-50 w-full text-left transition-colors ${k==="crop-insurance"?"text-lime-800 font-bold":"text-gray-600"}`,style:k==="crop-insurance"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,title:A?"":"Crop Insurance",children:[e.jsx(Is,{size:24,className:"flex-shrink-0"}),A&&e.jsx("span",{children:"Crop Insurance"})]})]})]}),e.jsxs("button",{onClick:()=>W("claims"),className:`flex items-center ${A?"gap-3 px-4":"justify-center px-2"} py-2.5 rounded-lg w-full text-left transition-colors ${k==="claims"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-50"}`,style:k==="claims"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,title:A?"":"Cash Assistance Claims",children:[e.jsx(Pe,{size:24,className:"flex-shrink-0"}),A&&e.jsx("span",{children:"Cash Assistance Claims"})]}),e.jsxs("button",{onClick:()=>W("distribution"),className:`flex items-center ${A?"gap-3 px-4":"justify-center px-2"} py-2.5 rounded-lg w-full text-left transition-colors ${k==="distribution"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-50"}`,style:k==="distribution"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,title:A?"":"Distribution Records",children:[e.jsx($s,{size:24,className:"flex-shrink-0"}),A&&e.jsx("span",{children:"Distribution Records"})]}),A&&e.jsx("hr",{className:"border-gray-100 my-4"}),e.jsxs("button",{onClick:()=>W("assistance"),className:`flex items-center ${A?"gap-3 px-4":"justify-center px-2"} py-2.5 rounded-lg w-full text-left transition-colors ${k==="assistance"?"text-lime-800 font-bold":"text-gray-700 hover:bg-gray-50"}`,style:k==="assistance"?{backgroundColor:"rgba(43, 158, 102, 0.15)"}:void 0,title:A?"":"Assistance Inventory",children:[e.jsx(Ts,{size:24,className:"flex-shrink-0"}),A&&e.jsx("span",{children:"Assistance Inventory"})]}),A&&e.jsx("div",{className:"px-3",children:e.jsxs("button",{onClick:()=>ms(!0),className:"flex items-center gap-3 px-4 py-2.5 rounded-lg w-full text-left transition-colors text-gray-700 hover:bg-gray-50",title:"Add Government Assistance",children:[e.jsx(is,{size:24}),e.jsx("span",{children:"Add Government Assistance"})]})})]}),A&&e.jsx("div",{className:"px-3 space-y-2 text-sm mt-4 max-h-[300px] overflow-y-auto hide-scrollbar"})]}),e.jsxs("main",{className:"flex-1 p-4 bg-gradient-to-b from-zinc-50 to-white",children:[k==="home"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3 mt-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-white to-[rgb(215,245,211)] rounded-xl shadow-lg p-2 flex flex-col items-center text-center text-gray-800",children:[e.jsx("div",{className:"text-sm font-bold text-black",children:"Farmers Registered (Kapalong)"}),e.jsx("div",{className:"text-xl text-gray-600 mt-1",children:fa})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white to-[rgb(215,245,211)] rounded-xl shadow-lg p-2 flex flex-col items-center text-center text-gray-800",children:[e.jsx("div",{className:"text-sm font-bold text-black",children:"Active Insurance Policies"}),e.jsx("div",{className:"text-xl text-gray-600 mt-1",children:y.filter(s=>s.insuranceType&&s.periodTo&&new Date(s.periodTo)>new Date).length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white to-[rgb(215,245,211)] rounded-xl shadow-lg p-2 flex flex-col items-center text-center text-gray-800 relative",children:[e.jsx("div",{className:"text-sm font-bold text-black",children:"Pending Insurance Claims"}),e.jsx("div",{className:"text-xl text-gray-600 mt-1",children:ba})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white to-[rgb(215,245,211)] rounded-xl shadow-lg p-2 flex flex-col items-center text-center text-gray-800",children:[e.jsx("div",{className:"text-sm font-bold text-black",children:"Farmers Assisted (No. of Beneficiaries)"}),e.jsx("div",{className:"text-xl text-gray-600 mt-1",children:L.filter(s=>s.status==="distributed"||s.status==="approved").length+ya})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white to-[rgb(215,245,211)] rounded-xl shadow-lg p-2 flex flex-col items-center text-center text-gray-800",children:[e.jsx("div",{className:"text-sm font-bold text-black",children:"Avg. Processing Time (days)"}),e.jsx("div",{className:"text-xl text-gray-600 mt-1",children:(()=>{const s=f.filter(r=>r.status==="approved"||r.status==="rejected");if(s.length===0)return"0";const t=s.reduce((r,g)=>{const w=new Date(g.date),_=new Date(g.reviewDate||g.date),U=Math.ceil((_-w)/(1e3*60*60*24));return r+Math.max(U,0)},0);return Math.round(t/s.length)})()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mt-4",children:[e.jsxs("div",{className:"lg:col-span-2 p-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Claims Trend Over Time"}),e.jsx("select",{value:vt,onChange:s=>ta(parseInt(s.target.value)),className:"px-3 py-2 text-sm border rounded-md",children:Array.from({length:3},(s,t)=>new Date().getFullYear()-t).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx("div",{className:"h-[500px]",children:e.jsx(st,{width:"100%",height:"100%",children:e.jsxs(_t,{data:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((t,r)=>{const g=f.filter(w=>new Date(w.date).getMonth()===r&&new Date(w.date).getFullYear()===vt);return{month:t,filed:g.length,approved:g.filter(w=>w.status==="approved").length,rejected:g.filter(w=>w.status==="rejected").length}}),margin:{top:30,right:40,left:30,bottom:80},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"filedGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#14b8a6",stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:"#14b8a6",stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"approvedGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#2f7d32",stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:"#2f7d32",stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"rejectedGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"rgb(174, 200, 28)",stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:"rgb(174, 200, 28)",stopOpacity:.1})]})]}),e.jsx(tt,{dataKey:"month",fontSize:14,axisLine:!0,tickLine:!1,label:{value:"Month",position:"insideBottom",offset:-15,style:{textAnchor:"middle",fontSize:14}}}),e.jsx(at,{fontSize:14,axisLine:!0,tickLine:!1,label:{value:"Number of Claims",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fontSize:14}}}),e.jsx(rt,{formatter:(s,t)=>[s,{filed:"Filed Claims",approved:"Approved Claims",rejected:"Rejected Claims"}[t]||t]}),e.jsx(Ga,{verticalAlign:"top",height:36,formatter:s=>({filed:"Filed Claims",approved:"Approved Claims",rejected:"Rejected Claims"})[s]||s}),e.jsx(fs,{type:"monotone",dataKey:"filed",stroke:"#14b8a6",strokeWidth:3,fill:"url(#filedGradient)",fillOpacity:1,dot:!1}),e.jsx(fs,{type:"monotone",dataKey:"approved",stroke:"#2f7d32",strokeWidth:3,fill:"url(#approvedGradient)",fillOpacity:1,dot:!1}),e.jsx(fs,{type:"monotone",dataKey:"rejected",stroke:"rgb(174, 200, 28)",strokeWidth:3,fill:"url(#rejectedGradient)",fillOpacity:1,dot:!1})]})})})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Assistance Application Breakdown"}),e.jsx("div",{className:"h-[220px] relative",children:e.jsx(Pt,{data:{labels:["Pending","Approved","Rejected","Distributed"],datasets:[{data:[L.filter(s=>s.status==="pending").length,L.filter(s=>s.status==="approved").length,L.filter(s=>s.status==="rejected").length,L.filter(s=>s.status==="distributed").length],backgroundColor:["#84cc16","#22c55e","rgb(174, 200, 28)","#10b981"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{font:{size:8},padding:10,usePointStyle:!0,generateLabels:function(s){const t=s.data,r=t.datasets[0].data.reduce((g,w)=>g+w,0);return t.labels.map((g,w)=>{const _=t.datasets[0].data[w],U=r>0?(_/r*100).toFixed(1):"0";return{text:`${g}: ${_} (${U}%)`,fillStyle:t.datasets[0].backgroundColor[w],strokeStyle:t.datasets[0].backgroundColor[w],lineWidth:0,pointStyle:"circle"}})}}},tooltip:{callbacks:{label:function(s){const t=s.label||"",r=s.parsed,g=s.dataset.data.reduce((_,U)=>_+U,0),w=g>0?(r/g*100).toFixed(1):"0";return`${t}: ${r} (${w}%)`}}}},layout:{padding:{top:20,bottom:20}}}})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Crop Market Prices (₱/kg)"}),e.jsx("span",{className:"text-sm text-gray-500",children:"PH Average"})]}),e.jsx("div",{className:"h-[220px]",children:e.jsx(st,{width:"100%",height:"100%",children:e.jsxs(Va,{data:[{crop:"Rice",price:45},{crop:"Corn",price:28},{crop:"Banana",price:35},{crop:"Coconut",price:18},{crop:"Coffee",price:120}],children:[e.jsx(tt,{dataKey:"crop",fontSize:10,angle:-45,textAnchor:"end",height:60,axisLine:!0,tickLine:!1}),e.jsx(at,{fontSize:10,axisLine:!0,tickLine:!1}),e.jsx(rt,{formatter:s=>[`₱${s}/kg`,"Price"]}),e.jsxs(Ja,{dataKey:"price",radius:[4,4,0,0],children:[e.jsx(gs,{fill:"#689c3c"}),e.jsx(gs,{fill:"#7fff00"}),e.jsx(gs,{fill:"#ccff00"}),e.jsx(gs,{fill:"#e6e6fa"}),e.jsx(gs,{fill:"#808000"})]})]})})})]})]})]}),e.jsx("div",{className:"mt-8 mb-6",children:e.jsx("hr",{className:"border-gray-200"})}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"🗺️ Geo-Tagging Map Overview"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:js,onChange:s=>na(s.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded-md",title:"Filter by crop",children:[e.jsx("option",{value:"all",children:"All Crops"}),Ma.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:Ns,onChange:s=>la(s.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded-md",title:"Filter by month",children:[e.jsx("option",{value:"all",children:"All Months"}),e.jsx("option",{value:"1",children:"Jan"}),e.jsx("option",{value:"2",children:"Feb"}),e.jsx("option",{value:"3",children:"Mar"}),e.jsx("option",{value:"4",children:"Apr"}),e.jsx("option",{value:"5",children:"May"}),e.jsx("option",{value:"6",children:"Jun"}),e.jsx("option",{value:"7",children:"Jul"}),e.jsx("option",{value:"8",children:"Aug"}),e.jsx("option",{value:"9",children:"Sep"}),e.jsx("option",{value:"10",children:"Oct"}),e.jsx("option",{value:"11",children:"Nov"}),e.jsx("option",{value:"12",children:"Dec"})]}),e.jsxs("select",{value:vs,onChange:s=>ia(s.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded-md",title:"Filter by year",children:[e.jsx("option",{value:"all",children:"All Years"}),Array.from({length:36},(s,t)=>1990+t).map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Legend:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Insured"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Uninsured"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),e.jsx("span",{className:"text-xs text-gray-600",children:"High Claims Area"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx("input",{type:"checkbox",defaultChecked:!1,onChange:s=>{z.current&&s.target.checked},className:"rounded"}),"Claims Heatmap"]}),e.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx("input",{type:"checkbox",defaultChecked:!1,onChange:s=>{z.current&&s.target.checked},className:"rounded"}),"Disaster Impact"]})]})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"💡 Hover over pins for detailed farmer information • Color-coded by barangay and insurance status"})]}),e.jsx("div",{className:"w-full h-[420px] rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{ref:$,className:"w-full h-full"})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(De,{size:16,className:"text-amber-500 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Pending Insurance Claims"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-amber-100 text-amber-700 text-xs font-medium rounded-full",children:f.filter(s=>s.status==="pending").length})]}),e.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg border border-gray-200 overflow-hidden",children:f.filter(s=>s.status==="pending").length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Ts,{size:24,className:"text-gray-400"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No pending claims at the moment"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:f.filter(s=>s.status==="pending").sort((s,t)=>{const r=Number.parseFloat(s.degreeOfDamage)||Number.parseFloat(s.areaDamaged)||0;return(Number.parseFloat(t.degreeOfDamage)||Number.parseFloat(t.areaDamaged)||0)-r}).map(s=>{var t;return e.jsx("div",{className:"p-3 hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-8 bg-amber-400 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mr-1"}),s.crop||s.cropType||"Unknown Crop"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mr-1"}),s.damageType||s.type||"Damage Type"]}),e.jsxs("span",{className:"flex items-center font-mono",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mr-1"}),"ID: ",(t=s.claimNumber||s._id)==null?void 0:t.slice(-6)]})]})]})]})}),e.jsx("div",{className:"flex items-center space-x-2 ml-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:"Pending Review"})})]})},s._id)})})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Pe,{size:16,className:"text-lime-600 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Recent Claims"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-lime-100 text-lime-700 text-xs font-medium rounded-full",children:f.slice(0,5).length})]}),e.jsx("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg border border-gray-200 overflow-hidden",children:f.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Pe,{size:24,className:"text-gray-400"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No recent claims found"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:f.slice(0,5).map(s=>{var t;return e.jsx("div",{className:"p-3 hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-8 rounded-full flex-shrink-0 ${s.status==="approved"?"bg-green-400":s.status==="rejected"?"bg-[rgb(26,61,59)]":s.status==="pending"?"bg-amber-400":"bg-gray-400"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mr-1"}),s.crop||s.cropType||"Unknown Crop"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mr-1"}),new Date(s.date).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center font-mono",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mr-1"}),"ID: ",(t=s.claimNumber||s._id)==null?void 0:t.slice(-6)]})]})]})]})}),e.jsx("div",{className:"flex items-center space-x-2 ml-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="rejected"?"bg-[rgb(26,61,59)] text-white":s.status==="pending"?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}`,children:s.status?s.status.charAt(0).toUpperCase()+s.status.slice(1):"Unknown"})})]})},s._id)})})})]})]}),k==="claims"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Cash Assistance Claims"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Es("pending"),className:`px-4 py-2 rounded-lg ${Ms==="pending"?"bg-lime-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Pending Cash Assistance Claims"}),e.jsx("button",{onClick:()=>Es("all"),className:`px-4 py-2 rounded-lg ${Ms==="all"?"bg-lime-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Claims"})]})]}),f&&f.length>0?e.jsx(Pr,{claims:f,claimsTabView:Ms,setClaimsTabView:Es,showClaimDetails:Ee,setShowClaimDetails:Se,selectedClaim:yt,setSelectedClaim:jt,showConfirmationModal:cs,setShowConfirmationModal:Ze,confirmationAction:M,setConfirmationAction:ne,openClaimDetails:Da,initiateStatusUpdate:Dt,confirmStatusUpdate:Hs,searchQuery:Ra,setSearchQuery:Pa}):e.jsx("div",{className:"text-center py-10 text-gray-500 italic text-lg",children:"No claims found."})]}),k==="farmer-registration"&&e.jsx(zr,{showMapModal:Ae,setShowMapModal:Ye,mapMode:Ue,setMapMode:ss,selectedLocation:_e,setSelectedLocation:us,mapCenter:ts,setMapCenter:aa,mapZoom:Ys,setMapZoom:ra,mapRef:Qe,leafletMapRef:a,markersLayerRef:N,mapSearchQuery:xs,setMapSearchQuery:qs,searchLocation:As,addFarmersToMap:Ws,formData:ps,setFormData:Cs,reverseGeocode:ks}),k==="distribution"&&e.jsx(Lr,{claims:f,approvedClaims:f.filter(s=>s.status==="approved").length,generateAnalytics:La,analyticsLoading:da,allApplications:L}),k==="assistance"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mr-4",children:"Assistance Inventory"}),e.jsxs("button",{onClick:()=>ms(!0),className:"flex items-center gap-2 bg-gradient-to-r from-lime-500 to-lime-600 text-white px-4 py-2 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",children:[e.jsx("span",{className:"text-xl font-bold",children:"+"}),e.jsx("span",{className:"font-semibold",children:"Add New Assistance"})]})]}),ae&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Loading assistance inventory..."})}),oe&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:e.jsxs("p",{children:["Error: ",oe]})}),!ae&&!oe&&e.jsx("div",{className:"bg-white/60 rounded-2xl shadow-xl p-6 mb-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Js.length>0?Js.map((s,t)=>e.jsxs("div",{className:"relative group rounded-2xl shadow-xl p-0 bg-gradient-to-br from-lime-100 via-white to-lime-50 border-2 border-lime-200 hover:shadow-2xl transition-all duration-300 flex flex-col items-stretch min-h-[260px]",children:[e.jsx("div",{className:"absolute top-0 right-0 px-4 py-1 rounded-bl-2xl text-xs font-bold tracking-wider z-10 bg-lime-600 text-white shadow-md",children:s.assistanceType}),s.photo&&e.jsx("div",{className:"flex items-center justify-center w-full h-32 rounded-t-2xl border-b border-lime-100 overflow-hidden",children:e.jsx("img",{src:s.photo,alt:"Assistance Logo",className:"object-contain w-full h-full"})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between p-5 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full border ${(s.availableQuantity||0)<5?"bg-red-100 text-red-700 border border-red-300":"bg-lime-100 text-lime-800 border-lime-300"}`,children:(s.availableQuantity||0)<5?"Low Stock":"Available"}),s.requiresRSBSA&&e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-orange-100 text-orange-700 border border-orange-300 ml-2",children:"RSBSA Required"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Crop: ",e.jsx("span",{className:"font-semibold text-gray-700",children:s.cropType})]}),e.jsxs("span",{children:["Founder: ",e.jsx("span",{className:"font-semibold text-gray-700",children:s.founderName})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Available: ",e.jsx("span",{className:"font-semibold text-gray-700",children:s.availableQuantity||0})]}),e.jsxs("span",{children:["Max/Farmer: ",e.jsxs("span",{className:"font-semibold text-gray-700",children:[s.maxQuantityPerFarmer||100,"kg"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:e.jsxs("span",{children:["Date Added: ",e.jsx("span",{className:"font-semibold text-gray-700",children:new Date(s.dateAdded).toLocaleDateString()})]})})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{onClick:()=>ue(s),className:"flex-1 flex items-center justify-center gap-1 bg-blue-600 text-white px-3 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition",children:"View"}),e.jsx("button",{onClick:()=>va(t),className:"flex-1 flex items-center justify-center gap-1 bg-lime-600 text-white px-3 py-2 rounded-lg font-semibold shadow hover:bg-lime-700 transition",children:"Edit"}),e.jsx("button",{onClick:()=>wa(t),className:"flex-1 flex items-center justify-center gap-1 bg-red-600 text-white px-3 py-2 rounded-lg font-semibold shadow hover:bg-red-700 transition",children:"Delete"})]})]})]},s._id||t)):e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:"No assistance items available"})})}),rs>1&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs("nav",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Gs(s=>Math.max(s-1,1)),disabled:Ge===1,className:`px-3 py-1 rounded-md ${Ge===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:"Previous"}),[...Array(rs)].map((s,t)=>e.jsx("button",{onClick:()=>Gs(t+1),className:`px-3 py-1 rounded-md ${Ge===t+1?"bg-lime-700 text-white":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:t+1},t)),e.jsx("button",{onClick:()=>Gs(s=>Math.min(s+1,rs)),disabled:Ge===rs,className:`px-3 py-1 rounded-md ${Ge===rs?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:"Next"})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Assistance Applications"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("select",{value:n,onChange:s=>{h(s.target.value),G(1)},className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-lime-500 focus:border-lime-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"distributed",children:"Distributed"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search ID or farmer name...",value:I,onChange:s=>{V(s.target.value),G(1)},className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:ring-lime-500 focus:border-lime-500 w-64"})]}),e.jsxs("button",{onClick:()=>{},className:"px-4 py-2 bg-lime-600 text-white rounded-md hover:bg-lime-700 transition text-sm font-medium flex items-center gap-2",children:[e.jsx(gr,{className:"h-4 w-4"}),"Refresh"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:c.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b text-sm text-gray-600 bg-gray-50 rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:["Showing ",(F-1)*re+1," to ",Math.min(F*re,c.length)," of ",c.length," applications",n&&` (filtered by: ${n})`,I&&` (search: "${I}")`]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Total in database: ",L.length]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Application ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Farmer Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assistance Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity Requested"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quarter"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Applied"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:me.map(s=>{var t,r,g,w,_,U,O;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:s._id.slice(-6).toUpperCase()})}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-[120px]",title:s._id,children:s._id})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.farmerId?`${s.farmerId.firstName} ${s.farmerId.lastName}`:"N/A"}),((t=s.farmerId)==null?void 0:t.cropType)&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Primary crop: ",s.farmerId.cropType]}),((r=s.farmerId)==null?void 0:r.rsbsaRegistered)&&e.jsx("div",{className:"text-xs text-green-600 mt-1",children:"✓ RSBSA Registered"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:((g=s.assistanceId)==null?void 0:g.assistanceType)||"N/A"}),((w=s.assistanceId)==null?void 0:w.cropType)&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["For: ",s.assistanceId.cropType," farmers"]}),((_=s.assistanceId)==null?void 0:_.founderName)&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["By: ",s.assistanceId.founderName]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.jsxs("div",{className:"font-medium",children:[s.requestedQuantity,"kg"]}),((U=s.assistanceId)==null?void 0:U.maxQuantityPerFarmer)&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Max allowed: ",s.assistanceId.maxQuantityPerFarmer,"kg"]}),((O=s.assistanceId)==null?void 0:O.availableQuantity)!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Available: ",s.assistanceId.availableQuantity,"kg"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:s.quarter})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.jsx("div",{children:new Date(s.applicationDate).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(s.applicationDate).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="rejected"?"bg-red-100 text-red-800":s.status==="distributed"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),s.reviewDate&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Reviewed: ",new Date(s.reviewDate).toLocaleDateString()]}),s.distributionDate&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Distributed: ",new Date(s.distributionDate).toLocaleDateString()]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[s.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ca(s._id),className:"text-green-600 hover:text-green-800 font-medium px-3 py-1 rounded border border-green-200 hover:bg-green-50 transition text-xs",children:"Approve"}),e.jsx("button",{onClick:()=>ka(s._id),className:"text-red-600 hover:text-red-800 font-medium px-3 py-1 rounded border border-red-200 hover:bg-red-50 transition text-xs",children:"Reject"})]}),s.status==="approved"&&e.jsx("button",{onClick:()=>Aa(s._id),className:"text-blue-600 hover:text-blue-800 font-medium px-3 py-1 rounded border border-blue-200 hover:bg-blue-50 transition text-xs",children:"Mark Distributed"}),(s.status==="rejected"||s.status==="distributed")&&e.jsx("span",{className:"text-gray-400 text-xs",children:"No actions available"}),s.officerNotes&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 italic",title:s.officerNotes,children:["Note: ",s.officerNotes.length>20?s.officerNotes.substring(0,20)+"...":s.officerNotes]})]})]},s._id)})})]})}),T>1&&e.jsxs("div",{className:"flex justify-between items-center p-4 border-t bg-gray-50 rounded-b-lg",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",F," of ",T]}),e.jsxs("nav",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>G(1),disabled:F===1,className:`px-3 py-1 rounded-md text-sm ${F===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:"First"}),e.jsx("button",{onClick:()=>G(s=>Math.max(s-1,1)),disabled:F===1,className:`px-3 py-1 rounded-md text-sm ${F===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:"Previous"}),[...Array(Math.min(5,T))].map((s,t)=>{const r=F<=3?t+1:F>=T-2?T-4+t:F-2+t;return r>0&&r<=T?e.jsx("button",{onClick:()=>G(r),className:`px-3 py-1 rounded-md text-sm ${F===r?"bg-lime-700 text-white":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:r},r):null}),e.jsx("button",{onClick:()=>G(s=>Math.min(s+1,T)),disabled:F===T,className:`px-3 py-1 rounded-md text-sm ${F===T?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:"Next"}),e.jsx("button",{onClick:()=>G(T),disabled:F===T,className:`px-3 py-1 rounded-md text-sm ${F===T?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-lime-100 text-lime-800 hover:bg-lime-200"}`,children:"Last"})]})]})]}):e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"text-center py-8 text-gray-500",children:L.length===0?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"No assistance applications found"}),e.jsx("p",{className:"text-sm mt-2",children:"Applications from farmers will appear here once they apply for assistance."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"No applications match your filters"}),e.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your search criteria or clearing filters."}),e.jsx("button",{onClick:()=>{h(""),V(""),G(1)},className:"mt-4 px-4 py-2 bg-lime-600 text-white rounded-md hover:bg-lime-700 transition text-sm font-medium",children:"Clear All Filters"})]})})})})]})]}),K&&se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Assistance Details"}),e.jsx("button",{onClick:()=>Z(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Assistance Type"}),e.jsx("p",{className:"text-gray-900",children:se.assistanceType})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Founder"}),e.jsx("p",{className:"text-gray-900",children:se.founderName})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Quantity"}),e.jsx("p",{className:"text-gray-900",children:se.quantity})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Date Added"}),e.jsx("p",{className:"text-gray-900",children:se.dateAdded})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Farmers Availed"}),e.jsx("div",{className:"mt-2",children:(($t=se.farmersAvailed)==null?void 0:$t.length)>0?e.jsx("ul",{className:"space-y-2",children:se.farmersAvailed.map((s,t)=>e.jsx("li",{className:"text-gray-900",children:s},t))}):e.jsx("p",{className:"text-gray-500",children:"No farmers have availed this assistance yet."})})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>Z(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Close"})})]})}),k==="crop-insurance"&&e.jsx("div",{className:"p-6",children:e.jsx(Er,{})}),k==="settings"&&e.jsx(Rr,{})]})]}),e.jsx(Mr,{showModal:Zt,setShowModal:Xt,modalForm:ma,setModalForm:xa,initialModalForm:kt,selectedLocation:_e,setSelectedLocation:us,setShowMapModal:Ye,setMapMode:ss,showEventModal:ea,setShowEventModal:ms,eventForm:we,handleEventChange:ja,handleEventSubmit:Na,showRegisterForm:sa,setShowRegisterForm:Nt,formData:ps,handleChange:pa,handleSubmit:ga,showClaimDetails:Ee,setShowClaimDetails:Se,selectedClaim:yt,initiateStatusUpdate:Dt,showConfirmationModal:cs,setShowConfirmationModal:Ze,confirmationAction:M,confirmStatusUpdate:Hs,showMapModal:Ae,mapMode:Ue,mapSearchQuery:xs,setMapSearchQuery:qs,searchLocation:As,mapRef:Qe,showFarmerDetails:xe,setShowFarmerDetails:Bs,showDeleteConfirmation:He,setShowDeleteConfirmation:_s,farmerToDelete:ua,setFarmerToDelete:Us,farmers:y,feedbackText:Le,setFeedbackText:Xe}),Ke&&v&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Predictive Analytics"}),e.jsx("button",{onClick:()=>os(!1),className:"text-white hover:text-gray-200 focus:outline-none",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx(ot,{className:"mr-2 h-5 w-5 text-lime-600"}),"Current Year Overview"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Total: ",v.currentYear.totalClaims]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Monthly Completion Rates"}),e.jsx("div",{className:"h-60",children:e.jsx(ls,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Claims"}}},elements:{line:{tension:.4},point:{radius:3}}},data:{labels:Object.keys(v.currentYear.monthlyStatus),datasets:[{label:"Approved",data:Object.values(v.currentYear.monthlyStatus).map(s=>s.approved||0),borderColor:"rgba(16, 185, 129, 1)",backgroundColor:"rgba(16, 185, 129, 0.1)",fill:!0,borderWidth:2},{label:"Rejected",data:Object.values(v.currentYear.monthlyStatus).map(s=>s.rejected||0),borderColor:"rgba(239, 68, 68, 1)",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!0,borderWidth:2},{label:"Completed",data:Object.values(v.currentYear.monthlyStatus).map(s=>s.completed||0),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,borderWidth:2}]}})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Status Distribution"}),e.jsx("div",{className:"h-60",children:e.jsx(Pt,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{boxWidth:12}}}},data:{labels:["Approved","Rejected","Pending","Completed"],datasets:[{data:[v.currentYear.byStatus.approved||0,v.currentYear.byStatus.rejected||0,v.currentYear.byStatus.pending||0,v.currentYear.byStatus.completed||0],backgroundColor:["rgba(16, 185, 129, 0.8)","rgba(239, 68, 68, 0.8)","rgba(245, 158, 11, 0.8)","rgba(59, 130, 246, 0.8)"],borderWidth:1}]}})})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx(gt,{className:"mr-2 h-5 w-5 text-blue-600"}),"Next Year Forecast"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Predicted Total: ",v.nextYear.totalClaims]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Predicted Monthly Trends"}),e.jsx("div",{className:"h-60",children:e.jsx(ls,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Predicted Claims"},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{grid:{color:"rgba(0, 0, 0, 0.05)"}}},elements:{line:{tension:.4},point:{radius:3}}},data:{labels:Object.keys(v.nextYear.monthlyStatus||{}),datasets:[{label:"Approved",data:Object.values(v.nextYear.monthlyStatus||{}).map(s=>s.approved||0),borderColor:"rgba(16, 185, 129, 1)",backgroundColor:"rgba(16, 185, 129, 0.1)",fill:!0,borderWidth:2},{label:"Rejected",data:Object.values(v.nextYear.monthlyStatus||{}).map(s=>s.rejected||0),borderColor:"rgba(239, 68, 68, 1)",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!0,borderWidth:2},{label:"Completed",data:Object.values(v.nextYear.monthlyStatus||{}).map(s=>s.completed||0),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,borderWidth:2}]}})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Predicted Status Distribution"}),e.jsx("div",{className:"h-60",children:e.jsx(Ls,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{boxWidth:12}}},cutout:"60%"},data:{labels:["Approved","Rejected","Pending","Completed"],datasets:[{data:[v.nextYear.byStatus.approved||0,v.nextYear.byStatus.rejected||0,v.nextYear.byStatus.pending||0,v.nextYear.byStatus.completed||0],backgroundColor:["rgba(16, 185, 129, 0.8)","rgba(239, 68, 68, 0.8)","rgba(245, 158, 11, 0.8)","rgba(59, 130, 246, 0.8)"],borderWidth:1}]}})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 md:col-span-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx(et,{className:"mr-2 h-5 w-5 text-lime-600"}),"Resource Allocation Recommendations"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Key Insights"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2 text-sm",children:[e.jsxs("li",{children:["Predicted ",v.nextYear.totalClaims-v.currentYear.totalClaims," more claims next year (",Math.round((v.nextYear.totalClaims-v.currentYear.totalClaims)/v.currentYear.totalClaims*100),"% increase)"]}),e.jsxs("li",{children:[Object.entries(v.nextYear.byMonth||{}).sort((s,t)=>t[1]-s[1]).slice(0,2).map(([s])=>s).join(" and ")," ","will likely see the highest claim volumes"]}),e.jsxs("li",{children:["Approval rate is expected to be"," ",Math.round(v.nextYear.byStatus.approved/v.nextYear.totalClaims*100),"% next year"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Monthly Processing Forecast"}),e.jsx("div",{className:"h-60",children:e.jsx(ls,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Claims"},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{grid:{color:"rgba(0, 0, 0, 0.05)"}}},elements:{line:{tension:.1},point:{radius:2}}},data:{labels:Object.keys(v.nextYear.byMonth||{}),datasets:[{label:"Current Year",data:Object.values(v.currentYear.byMonth||{}),borderColor:"rgba(107, 114, 128, 1)",backgroundColor:"rgba(107, 114, 128, 0.1)",borderWidth:2,borderDash:[5,5],fill:!1},{label:"Next Year (Predicted)",data:Object.values(v.nextYear.byMonth||{}),borderColor:"rgba(79, 70, 229, 1)",backgroundColor:"rgba(79, 70, 229, 0.1)",borderWidth:2,fill:!0}]}})})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx(De,{className:"mr-2 h-5 w-5 text-yellow-600"}),"Status Assessment"]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Status Efficiency"}),e.jsx("div",{className:"h-60",children:e.jsx(ct,{options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:s=>`${s.raw.toFixed(1)}% of total claims`}}},scales:{x:{beginAtZero:!0,max:100,title:{display:!0,text:"Percentage (%)"}}}},data:{labels:v.statusEfficiency.map(s=>s.status),datasets:[{label:"Status Percentage",data:v.statusEfficiency.map(s=>s.value),backgroundColor:v.statusEfficiency.map(s=>s.status==="Approved"?"rgba(16, 185, 129, 0.8)":s.status==="Rejected"?"rgba(239, 68, 68, 0.8)":s.status==="Pending"?"rgba(245, 158, 11, 0.8)":s.status==="Completed"?"rgba(59, 130, 246, 0.8)":"rgba(107, 114, 128, 0.8)"),borderRadius:4}]}})})]})})]})]}),e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsx("button",{onClick:()=>os(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition",children:"Close"}),e.jsxs("button",{onClick:Fa,className:"bg-lime-700 text-white px-4 py-2 rounded-lg hover:bg-lime-800 transition flex items-center",children:[e.jsx(hr,{className:"mr-2 h-5 w-5"}),"Download Full Report"]})]})]})]})}),Ae&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"sticky top-0 text-white p-4 rounded-t-xl flex justify-between items-center",style:{backgroundColor:"rgb(43, 158, 102)"},children:[e.jsx("h2",{className:"text-xl font-bold",children:Ue==="view"?"Farm Locations Map":"Select Farm Location"}),e.jsx("button",{onClick:()=>Ye(!1),className:"text-white hover:text-gray-200 focus:outline-none",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-4 border-b border-gray-200 flex flex-wrap gap-4 items-center",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search for a location...",value:xs,onChange:s=>qs(s.target.value),className:"w-full p-2 pr-10 border rounded-md",onKeyDown:s=>{s.key==="Enter"&&As()}}),e.jsx("button",{onClick:As,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx(Je,{className:"h-5 w-5"})})]})}),Ue==="view"&&e.jsxs("button",{onClick:()=>ss("add"),className:"bg-lime-600 text-white px-4 py-2 rounded hover:bg-lime-700 flex items-center",children:[e.jsx(is,{className:"mr-2 h-5 w-5"}),"Add Location"]}),Ue==="add"&&e.jsxs("button",{onClick:()=>ss("view"),className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 flex items-center",children:[e.jsx(We,{className:"mr-2 h-5 w-5"}),"View All Locations"]})]}),e.jsx("div",{className:"flex-1 min-h-[400px] relative",children:e.jsx("div",{ref:Qe,className:"w-full h-[500px]"})}),Ue==="add"&&e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:_e?e.jsxs("p",{className:"text-sm text-gray-600",children:["Selected coordinates: ",_e.lat.toFixed(6),", ",_e.lng.toFixed(6)]}):e.jsx("p",{className:"text-sm text-gray-600",children:"Click on the map to select a location"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ye(!1),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{onClick:()=>{_e?Ye(!1):alert("Please select a location on the map first.")},disabled:!_e,className:`px-4 py-2 bg-lime-700 text-white rounded hover:bg-lime-800 ${_e?"":"opacity-50 cursor-not-allowed"}`,children:"Confirm Location"})]})]})})]})}),xe&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"sticky top-0 bg-lime-700 text-white p-4 rounded-t-xl flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Farmer Details"}),e.jsx("button",{onClick:()=>Bs(!1),className:"text-white hover:text-gray-200 focus:outline-none transition-colors",children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-lime-800 mb-3 flex items-center gap-2",children:[e.jsx(Re,{size:20}),"Personal Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Full Name"}),e.jsx("p",{className:"font-medium",children:y[xe].farmerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Birthday"}),e.jsx("p",{className:"font-medium",children:y[xe].birthday||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Gender"}),e.jsx("p",{className:"font-medium",children:y[xe].gender||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Contact Number"}),e.jsx("p",{className:"font-medium",children:y[xe].contactNum||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"font-medium",children:y[xe].address})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Farm Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Type"}),e.jsx("p",{className:"font-medium",children:y[xe].cropType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Crop Area"}),e.jsxs("p",{className:"font-medium",children:[y[xe].cropArea," hectares"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Lot Number"}),e.jsx("p",{className:"font-medium",children:y[xe].lotNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Lot Area"}),e.jsx("p",{className:"font-medium",children:y[xe].lotArea||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Certified"}),e.jsx("p",{className:"font-medium",children:y[xe].isCertified?e.jsxs("span",{className:"text-green-600 flex items-center",children:[e.jsx(Te,{size:16,className:"mr-1"})," Yes"]}):e.jsx("span",{className:"text-gray-600",children:"No"})})]})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-3",children:"Insurance Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Insurance Type"}),e.jsx("p",{className:"font-medium",children:y[xe].insuranceType||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Premium Amount"}),e.jsx("p",{className:"font-medium",children:y[xe].premiumAmount||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Period From"}),e.jsx("p",{className:"font-medium",children:y[xe].periodFrom||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Period To"}),e.jsx("p",{className:"font-medium",children:y[xe].periodTo||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Agency"}),e.jsx("p",{className:"font-medium",children:y[xe].agency||"Not provided"})]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>Bs(!1),className:"bg-lime-700 text-white px-6 py-2 rounded-lg hover:bg-lime-800 transition",children:"Close"})})]})]})}),He&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 text-gray-800 flex items-center",children:[e.jsx(De,{className:"mr-2 text-red-500",size:24}),"Delete Farmer"]}),e.jsxs("p",{className:"mb-6 text-gray-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:y[He].farmerName}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{_s(!1),Us(null)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{try{const s=y[He].id||y[He]._id,t=y[He].farmerName||`${y[He].firstName} ${y[He].lastName}`;await qe.mutateAsync(s),_s(!1),Us(null),D.getState().addAdminNotification({id:S(),type:"success",title:"Farmer Deleted Successfully",message:`${t} has been removed from the system.`,timestamp:new Date})}catch(s){D.getState().addAdminNotification({id:S(),type:"error",title:"Delete Failed",message:`Error: ${s.message}`,timestamp:new Date})}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center",children:[e.jsx(ee,{size:16,className:"mr-1"}),"Delete"]})]})]})}),cs&&e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent bg-opacity-30 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:M.type==="approved"?"Approve Claim":"Reject Claim"}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["Are you sure you want to ",M.type==="approved"?"approve":"reject"," this claim? This action cannot be undone."]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"feedback",className:"block text-sm font-medium text-gray-700 mb-2",children:"Feedback (optional)"}),e.jsx("textarea",{id:"feedback",value:Le,onChange:s=>Xe(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-500",rows:3,placeholder:"Add feedback for the farmer..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>Ze(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Hs,className:`px-4 py-2 rounded-lg text-white ${M.type==="approved"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:M.type==="approved"?"Yes, Approve":"Yes, Reject"})]})]})}),Oe&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-30 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[fe.type==="approved"?"Approve":fe.type==="rejected"?"Reject":fe.type==="delete"?"Delete":"Action"," Application"]}),e.jsx("p",{className:"mb-4 text-gray-600",children:fe.type==="delete"?`Are you sure you want to delete "${fe.itemName}"? This action cannot be undone.`:`Are you sure you want to ${fe.type} this assistance application? 
                Please provide feedback for the farmer.`}),fe.type!=="delete"&&e.jsx("textarea",{className:"w-full border border-gray-300 rounded-lg p-3 mb-4 focus:ring-2 focus:ring-lime-500 focus:border-lime-500",rows:4,placeholder:`Enter feedback for the farmer (reason for ${fe.type})`,value:Me,onChange:s=>Be(s.target.value)}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{Ie(!1),Be("")},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Sa,className:`px-4 py-2 rounded-lg text-white transition-colors ${fe.type==="approved"?"bg-green-600 hover:bg-green-700":(fe.type==="rejected","bg-red-600 hover:bg-red-700")}`,children:fe.type==="approved"?"Yes, Approve":fe.type==="rejected"?"Yes, Reject":"Yes, Delete"})]})]})}),za&&be&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-30 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[be.type==="approve"?"Approve":"Reject"," Request"]}),e.jsxs("p",{className:"mb-2",children:["Farmer: ",e.jsx("span",{className:"font-medium",children:be.request.farmerName})]}),e.jsxs("p",{className:"mb-2",children:["Assistance: ",e.jsx("span",{className:"font-medium",children:be.request.assistanceName})]}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded-lg p-2 mb-4",rows:3,placeholder:`Enter feedback for the farmer (reason for ${be.type})`,value:Le,onChange:s=>Xe(s.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>Ks(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(be.type==="approve")D.getState().addFarmerNotification({id:`assist-approve-${be.request.id}`,title:"Assistance Request Approved",message:`Your request for ${be.request.assistanceName} was approved. Feedback: ${Le}`,type:"success",timestamp:new Date,read:!1},be.request.farmerId),Ks(!1),Tt(null),Xe("");else{try{await Y.mutateAsync({applicationId:be.request.id,statusData:{status:"rejected",adminFeedback:Le}}),D.getState().addAdminNotification({id:S(),type:"success",title:"Request Rejected",message:"Assistance request has been rejected.",timestamp:new Date})}catch(s){D.getState().addAdminNotification({id:S(),type:"error",title:"Error Rejecting Request",message:s.message,timestamp:new Date})}D.getState().addFarmerNotification({id:`assist-reject-${be.request.id}`,title:"Assistance Request Rejected",message:`Your request for ${be.request.assistanceName} was rejected. Feedback: ${Le}`,type:"warning",timestamp:new Date,read:!1},be.request.farmerId),Ks(!1),Tt(null),Xe("")}},className:`px-4 py-2 rounded text-white ${be.type==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:be.type==="approve"?"Approve":"Reject"})]})]})}),X.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-red-100 border border-red-300 text-red-800 rounded-lg flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5 text-red-500"}),e.jsxs("span",{children:["Warning: The following assistance item",X.length>1?"s are":" is"," low in stock:"," ",e.jsx("strong",{children:X.map(s=>s.assistanceType).join(", ")}),". Please restock soon."]})]})]})};export{tn as default};
